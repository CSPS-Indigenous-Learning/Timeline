/*QSB_V_0_9035*/function qsBeta(objAcc,paramObj){function fQsEvDp(t,e){return fCl("fQsEvDp("+t+")"),"undefined"==typeof fQsEventDispatcher||"function"!=typeof fQsEventDispatcher?!1:void fQsEventDispatcher(t,e)}function fFocus(t){return fCl("fFocus("+t+")"),mThis.settings.autoTabbing?void $(t).attr("tabindex",0).focus():!1}function fCl(t){mThis.settings.debugMode&&console.log(t)}function fCe(t){console.error(t)}function arrayHasOwnIndex(t,e){return t.hasOwnProperty(e)&&/^0$|^[1-9]\d*$/.test(e)&&4294967294>=e}function detectIE(){var t=window.navigator.userAgent,e=t.indexOf("MSIE ");if(e>0)return parseInt(t.substring(e+5,t.indexOf(".",e)),10);var i=t.indexOf("Trident/");if(i>0){var s=t.indexOf("rv:");return parseInt(t.substring(s+3,t.indexOf(".",s)),10)}var a=t.indexOf("Edge/");return a>0?parseInt(t.substring(a+5,t.indexOf(".",a)),10):!1}if(mThis=this,void 0===paramObj)paramObj={};else{var validParamsNames="debugMode,cheatMode,autoStart,encodeAnswers,animBaseDuration,masterIntTester,illegalCharsList,settingsFilename,settingsPath,settingsLabelsFilename,autoTabbing,language";for(var i in paramObj)if(validParamsNames.indexOf(i)<0)throw new Error("Invalid param detected: "+i)}var lang=void 0!==paramObj.language?paramObj.language:void 0!==$("html").attr("lang")?$("html").attr("lang"):"fr",settingsPath=void 0!==paramObj.settingsPath?paramObj.settingsPath:"settings/",settingsFilename=void 0!==paramObj.settingsFilename?paramObj.settingsFilename:"qssettings",settingsLabelsFilename=void 0!==paramObj.settingsLabelsFilename?paramObj.settingsLabelsFilename:"qslabels_",qsData;$.ajax({type:"GET",url:settingsPath+settingsFilename+".json",dataType:"json",error:function(t,e,i){fCe("qsData not loaded: "+e+"  "+i)},success:function(t){var e={settings:["autoTabbing","animBaseDuration","masterIntTester","encodeAnswers","illegalCharsList"],activity:["activity_type","question_skipping_enabled","tracking_enabled","recap_required","trigger_course_completion","trigger_completion_score","final_feedback_score_threshold","submit_all_at_once","submit_aao_disable_right_anwers","simple_act_disable_mode","reset_retry_enabled","animations_and_transitions","auto_scroll_to_question","force_insert_final_submit"],exercise:["exercise_type","pool_picks","random_order","feedback_type","randomize_answers","submit_all_at_once"],question:["question_type","branching_type","question_value"],type_0:["empty_allowed","min_char_required"],type_1:["crypt_answers","persistent_vsfb"],type_2:["crypt_answers","empty_allowed"],type_3:["ignore_case"],type_4:["allow_duplicate_answer","substitute_recap_label","randomize_options"],type_5:["crypt_answers"]},i="";for(var s in e)for(var a in e[s])void 0===t[0][s][e[s][a]]&&(i+=s+" / "+e[s][a]+"\n");if(""!==i)throw new Error("Missing setting:\n"+i);qsData=t[0]},async:!1});var qsLabels;$.ajax({type:"GET",url:settingsPath+settingsLabelsFilename+lang+".json",dataType:"json",error:function(t,e,i){fCe("qsLabels not loaded: "+e+"  "+i)},success:function(t){qsLabels=t[0]},async:!1}),this.settings=qsData.settings,this.settings.debugMode=void 0!=paramObj.debugMode?paramObj.debugMode:!1,this.settings.cheatMode=void 0!=paramObj.cheatMode?paramObj.cheatMode:!1,this.settings.autoStart=void 0!=paramObj.autoStart?paramObj.autoStart:!0;for(var i in paramObj)this.settings[i]=paramObj[i];this.msgs=qsLabels.msgs,this.objDefVal={},this.objDefVal.activity=qsData.activity,this.objDefVal.exercise=qsData.exercise,this.objDefVal.question=qsData.question,this.objDefVal.domButtons=qsLabels.domButtons,this.objDefVal.domVisuals=qsLabels.domVisuals;try{fCl(trackingObj.isLoaded)}catch(err){fCl("NO TRACKING OBJECT DETECTED, ALL TRACKING DISABLED\n"+err),trackingObj={},this.settings.debugMode?trackingObj.getData=function(){return $("#qs-tracking-debug").val()}:trackingObj.getData=function(){return!1},trackingObj.saveData=function(){return!1}}this.settings.encodeAnswers=void 0!=paramObj.encodeAnswers?paramObj.encodeAnswers:!1,this.settings.cheatMode&&(this.settings.encodeAnswers&&fCl("Answers are encoded, cheatMode not will not work!"),$(".qs-elearning-activity .ra").prop("checked",!0).parent().css("border","1px solid green"),$(".qs-elearning-activity .wa").parent().css("border","1px solid red"),$(".qs-elearning-activity input[type=text]").each(function(){$(this).attr("data-rep").indexOf("|")>-1?$(this).val($(this).attr("data-rep").split("|")[0]):$(this).val($(this).attr("data-rep"))}),$(".qs-elearning-activity select").each(function(){$(this).val($(this).attr("data-rep"))}));var isIE=!!detectIE();this.activities,this.activitiesArr=new Array;var qsMarkerStart="¹{",qsMarkerEnd="}¹",qsActMarkerStart="²{",qsActMarkerEnd="}²",qsExMarkerStart="³{",qsExMarkerEnd="}³";this.settings.illegalCharsList=void 0!=paramObj.illegalCharsList?paramObj.illegalCharsList:"¼½¾Ð¶¢®©ª¤£¦§±þ§Þß¥º·¹²³¨÷|";var tSplt=["¦","§","¤","±","º"],qSplt=["¼","½"],replaceIllegalCharWith="¿";this.settings.animBaseDuration=void 0!=paramObj.animBaseDuration?paramObj.animBaseDuration:200,this.settings.masterIntTester=void 0!=paramObj.masterIntTester||paramObj.masterIntTester<4?paramObj.masterIntTester:33;var statusStrings=["unattempted","incomplete","failed","completed"],trackingString="";this.objDefVal.type_0=qsData.type_0,this.objDefVal.type_1=qsData.type_1,this.objDefVal.type_2=qsData.type_2,this.objDefVal.type_3=qsData.type_3,this.objDefVal.type_4=qsData.type_4,this.objDefVal.type_5=qsData.type_5,this.qsInit=function(){fCl("QS INIT..."),this.qsValidateSemantic()||fCe("FAILED TO VALIDATE HTML, PLEASE CONTACT YOUR NETWORK ADMINISTRATOR!");var it,i,ii,iii,iRandom,iPrep,iQuest;for($(".qs-elearning-activity").addClass("qs-step1"),it=0;it<$(".qs-elearning-activity[data-tracking=true]").length;it++)this.qsGetTrackingString($(".qs-elearning-activity[data-tracking=true]").eq(it).attr("id"));for(i=0;i<$(".qs-elearning-activity").length;i++)for(currElem=$(".qs-elearning-activity").eq(i),this.activitiesArr[this.activitiesArr.length]={elem:currElem,id:$(currElem).attr("id"),nb_exercises:$(currElem).find(".qs-exercise").length,activity_type:void 0==$(currElem).attr("data-activity-type")?this.objDefVal.activity.activity_type:$(currElem).attr("data-activity-type"),question_skipping_enabled:void 0==$(currElem).attr("data-question-skipping")?this.objDefVal.activity.question_skipping_enabled:eval($(currElem).attr("data-question-skipping")),tracking_enabled:void 0==$(currElem).attr("data-tracking")?this.objDefVal.activity.tracking_enabled:eval($(currElem).attr("data-tracking")),recap_required:void 0==$(currElem).attr("data-force-final-recap")?this.objDefVal.activity.recap_required:eval($(currElem).attr("data-force-final-recap")),trigger_course_completion:void 0==$(currElem).attr("data-trigger-scorm-completion")?eval(this.objDefVal.activity.trigger_course_completion):eval($(currElem).attr("data-trigger-scorm-completion")),trigger_completion_score:void 0!=$(currElem).attr("data-trigger-completion-score")?eval($(currElem).attr("data-trigger-completion-score")):-1,final_feedback_score_threshold:void 0!=$(currElem).attr("data-trigger-completion-score")?eval($(currElem).attr("data-trigger-completion-score")):this.objDefVal.activity.final_feedback_score_threshold,submit_all_at_once:void 0==$(currElem).attr("data-submit-all-at-once")?this.objDefVal.activity.submit_all_at_once:eval($(currElem).attr("data-submit-all-at-once")),submit_aao_disable_right_anwers:void 0==$(currElem).attr("data-submit-aao-disable-right-answers")?this.objDefVal.activity.submit_aao_disable_right_anwers:eval($(currElem).attr("data-submit-aao-disable-right-answers")),simple_act_disable_mode:void 0==$(currElem).attr("data-simple-act-disable-mode")?this.objDefVal.activity.simple_act_disable_mode:$(currElem).attr("data-simple-act-disable-mode"),animations_and_transitions:this.objDefVal.activity.animations_and_transitions,auto_scroll_to_question:this.objDefVal.activity.auto_scroll_to_question,force_insert_final_submit:this.objDefVal.activity.force_insert_final_submit,exercises:new Object,dv:new Object({status:"unattempted",current_exercise_id:0,current_question_id:0})},this.activities=this.activitiesArr,this.exercisesArr=new Array,ii=0;ii<$(currElem).find(".qs-exercise").length;ii++){for(currElem_ii=$(currElem).find(".qs-exercise").eq(ii),inherit_question_type=void 0===$(currElem_ii).attr("data-question-type")?this.objDefVal.question.question_type:$(currElem_ii).attr("data-question-type"),inherit_feedback_type=void 0===$(currElem_ii).attr("data-feedback-type")?this.objDefVal.exercise.feedback_type:$(currElem_ii).attr("data-feedback-type"),inherit_random_answers=eval(void 0===$(currElem_ii).attr("data-random-answers")?this.objDefVal.exercise.randomize_answers:$(currElem_ii).attr("data-random-answers")),inherit_score_value=void 0===$(currElem_ii).attr("data-score-value")?1:Number($(currElem_ii).attr("data-score-value")),this.exercisesArr[this.exercisesArr.length]={elem:currElem_ii,id:$(currElem_ii).attr("id"),nb_questions:$(currElem_ii).find(".qs-question").length,exercise_type:void 0===$(currElem_ii).attr("data-exercise-type")?this.objDefVal.exercise.exercise_type:$(currElem_ii).attr("data-exercise-type"),branching_passing_grade:eval($(currElem_ii).attr("data-branching-passing-grade")),branching_pass_redirection:$(currElem_ii).attr("data-branching-pass-redirection"),branching_fail_redirection:$(currElem_ii).attr("data-branching-fail-redirection"),questions_type:inherit_question_type,feedback_type:inherit_feedback_type,recap_required:!1,submit_all_at_once:void 0==$(currElem_ii).attr("data-submit-all-at-once")?this.objDefVal.exercise.submit_all_at_once:eval($(currElem_ii).attr("data-submit-all-at-once")),randomize_answers:inherit_random_answers,randomize_questions:$(currElem_ii).attr("data-random-questions"),pool_picks:"true"==$(currElem_ii).attr("data-random-questions")?parseInt($(currElem_ii).attr("data-pool-picks")):"null",random_order:"null",score_value:inherit_score_value,dv:new Object({status:"unattempted"}),questions:new Object},this.activities[i].exercises=this.exercisesArr,"true"==this.activities[i].exercises[ii].randomize_questions?(qRandomStackArr=this.qsGetRandomQuestionStack(i,ii),this.activities[i].exercises[ii].random_order=qRandomStackArr.join(",")):qRandomStackArr=void 0,this.questionsArr=new Array,iii=0;iii<$(currElem_ii).find(".qs-question").length;iii++){if(fCl("Parsing Question - index:"+iii),void 0!=qRandomStackArr)for(iRandom=0;iRandom<qRandomStackArr.length;iRandom++)iii==qRandomStackArr[iRandom]&&(nID=iRandom);else nID=this.questionsArr.length;switch(currElem_iii=$(currElem_ii).find(".qs-question").eq(iii),this.questionsArr[nID]={elem:currElem_iii,id:$(currElem_iii).attr("id"),question_type:void 0===$(currElem_iii).attr("data-question-type")?inherit_question_type:$(currElem_iii).attr("data-question-type"),branching_type:void 0===$(currElem_iii).attr("data-branching-type")?this.objDefVal.question.branching_type:$(currElem_iii).attr("data-branching-type"),feedback_type:void 0===$(currElem_iii).attr("data-feedback-type")?inherit_feedback_type:$(currElem_iii).attr("data-feedback-type"),randomize_answers:void 0===$(currElem_iii).attr("data-random-answers")?inherit_random_answers:eval($(currElem_iii).attr("data-random-answers")),score_value:void 0===$(currElem_iii).attr("data-score-value")?inherit_score_value:Number($(currElem_iii).attr("data-score-value")),dv:new Object({my_answer_id:"",status:"unattempted"}),answers:new Object({elem:$(currElem_iii).find(".qs-answers")})},this.questionsArr[nID].question_type){case"type-1":this.questionsArr[nID].persistent_vsfb=this.objDefVal.type_1.persistent_vsfb;break;case"type-2":this.questionsArr[nID].empty_allowed=this.objDefVal.type_2.empty_allowed;break;case"type-3":this.questionsArr[nID].ignore_case=void 0==$(currElem_iii).attr("data-question-ignore-case")?this.objDefVal.type_3.ignore_case:eval($(currElem_iii).attr("data-question-ignore-case"));break;case"type-4":this.questionsArr[nID].allow_duplicate_answer=void 0==$(currElem_iii).attr("data-allow-duplicate-answer")?this.objDefVal.type_4.allow_duplicate_answer:eval($(currElem_iii).attr("data-allow-duplicate-answer")),this.questionsArr[nID].randomize_options=void 0==$(currElem_iii).attr("data-randomize-options")?this.objDefVal.type_4.randomize_options:eval($(currElem_iii).attr("data-randomize-options"));break;case"type-5":}switch(this.questionsArr[nID].question_type){case"type-1":if(!this.objDefVal.type_1.crypt_answers){fCl("Encryption disabled *WIP");break}if(this.settings.encodeAnswers){for(iQuest=0;iQuest<$("#"+this.questionsArr[nID].id).find("input.wa, input.ra").length;iQuest++)this.qsGenerateEncodedValidationString("gonogo",$("#"+this.questionsArr[nID].id).find("input.wa, input.ra").eq(iQuest).hasClass("ra")?1:0,$("#"+this.questionsArr[nID].id).find("input.wa, input.ra").eq(iQuest).attr("id"));$("#"+this.questionsArr[nID].id+' input[type="radio"]').removeClass("wa ra")}break;case"type-2":if(!this.objDefVal.type_2.crypt_answers){fCl("Encryption disabled *WIP");break}if(this.settings.encodeAnswers){for(iQuest=0;iQuest<$("#"+this.questionsArr[nID].id).find("input.wa, input.ra").length;iQuest++)this.qsGenerateEncodedValidationString("gonogo",$("#"+this.questionsArr[nID].id).find("input.wa, input.ra").eq(iQuest).hasClass("ra")?1:0,$("#"+this.questionsArr[nID].id).find("input.wa, input.ra").eq(iQuest).attr("id"));$("#"+this.questionsArr[nID].id+' input[type="checkbox"]').removeClass("wa ra")}break;case"type-3":if(this.settings.encodeAnswers){for(iQuest=0;iQuest<$("#"+this.questionsArr[nID].id).find('input[type="text"]').length;iQuest++)this.qsGenerateEncodedValidationString("encrypt",$("#"+this.questionsArr[nID].id).find('input[type="text"]').eq(iQuest).attr("data-rep"),$("#"+this.questionsArr[nID].id).find('input[type="text"]').eq(iQuest).attr("id"));$("#"+this.questionsArr[nID].id+' input[type="text"]').removeAttr("data-rep")}$("#"+this.questionsArr[nID].id+" input[type=text]").attr("onkeyup","return qsTFRestrictOnKey(this,event);");break;case"type-4":if(fCl("TYPE-4 RANDOM SELECT OPTIONS WILL NOT BE TRACKED *WIP*"),this.questionsArr[nID].randomize_options||"true"===this.questionsArr[nID].randomize_options)for(rsoi=0;rsoi<$("#"+this.questionsArr[nID].id+" select").length;rsoi++){for(dRep=$("#"+this.questionsArr[nID].id+" select").eq(rsoi).attr("data-rep"),tmpBuffArr=[],f1Dummy=!1,tmpBuffArr=$("#"+this.questionsArr[nID].id+" select").eq(rsoi).html().split("</option>"),$("#"+this.questionsArr[nID].id+" select").eq(rsoi).empty(),newMatrixArr=[],newMatrixArr=this.qsReturnRandomArr(tmpBuffArr.length-1),rsoii=0;rsoii<newMatrixArr.length;rsoii++)newMatrixArr[rsoii]==dRep,$("#"+this.questionsArr[nID].id+" select").eq(rsoi).append(tmpBuffArr[newMatrixArr[rsoii]]+"</option>");var tmpBuff;for(rsoii=0;rsoii<$("#"+this.questionsArr[nID].id+" select").eq(rsoi).find("option").length;rsoii++)"disabled"===$("#"+this.questionsArr[nID].id+" select").eq(rsoi).find("option").eq(rsoii).attr("disabled")&&$("#"+this.questionsArr[nID].id+" select").eq(rsoi).find("option").eq(rsoii).attr("selected")&&(tmpBuff=$("#"+this.questionsArr[nID].id+" select").eq(rsoi).find("option").get(rsoii).outerHTML,$("#"+this.questionsArr[nID].id+" select").eq(rsoi).find("option").eq(rsoii).remove());$("#"+this.questionsArr[nID].id+" select").eq(rsoi).prepend(tmpBuff)}break;case"type-5":if(!this.objDefVal.type_5.crypt_answers){fCl("Encryption disabled *WIP");break}if(this.settings.encodeAnswers){for(iQuest=0;iQuest<$("#"+this.questionsArr[nID].id).find("input.wa, input.ra").length;iQuest++)this.qsGenerateEncodedValidationString("gonogo",$("#"+this.questionsArr[nID].id).find("input.wa, input.ra").eq(iQuest).hasClass("ra")?1:0,$("#"+this.questionsArr[nID].id).find("input.wa, input.ra").eq(iQuest).attr("id"));$("#"+this.questionsArr[nID].id+' input[type="button"]').removeClass("wa ra")}}"deferred"!=this.questionsArr[nID].feedback_type||this.activities[i].recap_required||(this.activities[i].recap_required=this.activities[i].exercises[ii].recap_required=!0),!this.questionsArr[nID].randomize_answers||"type-1"!=this.questionsArr[nID].question_type&&"type-2"!=this.questionsArr[nID].question_type&&"type-5"!=this.questionsArr[nID].question_type||this.qsScrambleAnswers(this.questionsArr[nID].id,this.questionsArr[nID].question_type)}this.activities[i].exercises[ii].questions=this.questionsArr,"null"!=this.activities[i].exercises[ii].pool_picks&&iii>this.activities[i].exercises[ii].pool_picks-1&&(this.activities[i].exercises[ii].questions.splice(this.activities[i].exercises[ii].pool_picks,this.activities[i].exercises[ii].nb_questions-this.activities[i].exercises[ii].pool_picks),this.activities[i].exercises[ii].nb_questions=this.activities[i].exercises[ii].questions.length)}for(tmpNH=[],tmpCounter=1,iqn=0;iqn<this.activities.length;iqn++)for(iiqn=0;iiqn<this.activities[iqn].exercises.length;iiqn++)if("true"==this.activities[iqn].exercises[iiqn].randomize_questions)for(tmpNH=this.activities[iqn].exercises[iiqn].random_order.split(","),iiiqn=0;iiiqn<this.activities[iqn].exercises[iiqn].pool_picks;iiiqn++)$("#"+this.activities[iqn].exercises[iiqn].questions[iiiqn].id+" .qs-insert-question-number").html(tmpCounter),$("#"+this.activities[iqn].exercises[iiqn].questions[iiiqn].id+" .qs-insert-question-value").html(this.msgs.msgPtsPrefix+this.activities[iqn].exercises[iiqn].questions[iiiqn].score_value+this.msgs.msgPtsSuffix),tmpCounter++;else for(iiiqn=0;iiiqn<this.activities[iqn].exercises[iiqn].questions.length;iiiqn++)$("#"+this.activities[iqn].exercises[iiqn].questions[iiiqn].id+" .qs-insert-question-number").html(tmpCounter),$("#"+this.activities[iqn].exercises[iiqn].questions[iiiqn].id+" .qs-insert-question-value").html(this.msgs.msgPtsPrefix+this.activities[iqn].exercises[iiqn].questions[iiiqn].score_value+this.msgs.msgPtsSuffix),tmpCounter++;for($(".qs-elearning-activity[data-tracking=true]").length&&this.qsRecallData("all"),iPrep=0;iPrep<this.activities.length;iPrep++)this.qsPrepActivities(iPrep)},this.qsPrepActivities=function(t){fCl("qsPrepActivities("+t+")"),$("#"+this.activities[t].id+".qs-elearning-activity").removeClass("qs-step2 qs-step3").addClass("qs-step1"),qsHide($(this.activities[t].elem).find(".qs-subvisit, .qs-question, .qs-exercise, .qs-feedback, .qs-specific, .qs-second-chance, .qs-feedback-final, .qs-finallinkto-unanswered-placeholder")),qsShow($(this.activities[t].elem).find(".qs-firstvisit")),$(this.activities[t].elem).find(".qs-vsfbh").html(""),$("#"+this.activities[t].id+" .qs-start-activity").length?(qsShow("#"+this.activities[t].id+" .qs-start-activity"),fCl("FIND ME (in qsPrepActivities()) and hide stuff via CSS for added security and compatibility"),"unattempted"!=this.activities[t].dv.status&&(qsShow(".qs-start-activity .qs-subvisit"),qsHide(".qs-start-activity .qs-firstvisit"),fCe("Show subvisit, hide firstvisit"),$("#"+this.activities[t].id+" .qs-start-activity .qs-subvisit .qs-resetretry").unbind("click"),$("#"+this.activities[t].id+" .qs-start-activity .qs-subvisit .qs-resetretry").click(function(){$(this).hasClass("qs-disabled")||(fCl("---------------------------- PRESSED RESET ACTIVITY ----------------------------"),$(this).unbind(),mThis.qsResetActivity(t))}),$("#"+this.activities[t].id+" .qs-start-activity .qs-subvisit .qs-getbacktoit").click(function(){$(this).hasClass("qs-disabled")||(fCl("---------------------------- GO BACK TO WHERE I LEFT OFF ----------------------------"),$(this).unbind(),mThis.qsActivityInitialLaunch($(this).closest("div.qs-elearning-activity").attr("id")))})),$(this.activities[t].elem).find(".qs-start-activity .qs-start").click(function(){if(!$(this).hasClass("qs-disabled")){fCl("---------------------------- PRESSED START ----------------------------"),$(this).unbind();var t=$(this).closest("div.qs-elearning-activity").attr("id");mThis.activities[mThis.qsGetActivityIDFromStringID(t)].dv.current_exercise_id=0,mThis.activities[mThis.qsGetActivityIDFromStringID(t)].dv.current_question_id=0,mThis.activities[mThis.qsGetActivityIDFromStringID(t)].dv.status="incomplete",mThis.qsActivityInitialLaunch(t)}})):(this.activities[t].dv.current_exercise_id=0,this.activities[t].dv.current_question_id=0,this.activities[t].dv.status="incomplete",this.qsActivityInitialLaunch(this.activities[t].id)),this.qsUpdateScoreDisplay(t)},this.qsActivityInitialLaunch=function(t){current_activity_ID=this.qsGetActivityIDFromStringID(t),current_exercise_ID=this.activities[this.qsGetActivityIDFromStringID(t)].dv.current_exercise_id,current_question_ID=this.activities[this.qsGetActivityIDFromStringID(t)].dv.current_question_id,current_question_stringID=this.activities[current_activity_ID].exercises[current_exercise_ID].questions[current_question_ID].id,"branching"===this.activities[current_activity_ID].activity_type&&fCe('BRANCHING QUIZZES, WIP! -> Tracking not work correctly, recap not working, lots of options not working in conjonction with activity-type="branching"'),$("#"+t+".qs-elearning-activity").removeClass("qs-step1 qs-step3").addClass("qs-step2"),qsShow($("#"+current_question_stringID)),ancestrySTRARR=this.qsGetAncestryStringIDS($("#"+current_question_stringID)),$("#"+t+" .qs-start-activity").length?qsTransition($("#"+t+" .qs-start-activity"),$("#"+t+" #"+ancestrySTRARR[1]+".qs-exercise")):qsFadeIn($("#"+t+" #"+ancestrySTRARR[1]+".qs-exercise")),this.activities[current_activity_ID].exercises[current_exercise_ID].questions[current_question_ID].dv.status="unattempted"==this.activities[current_activity_ID].exercises[current_exercise_ID].questions[current_question_ID].dv.status?"incomplete":this.activities[current_activity_ID].exercises[current_exercise_ID].questions[current_question_ID].dv.status,this.activities[current_activity_ID].exercises[current_exercise_ID].dv.status="unattempted"===this.activities[current_activity_ID].exercises[current_exercise_ID].dv.status?"incomplete":this.activities[current_activity_ID].exercises[current_exercise_ID].dv.status,this.qsUpdateScoreDisplay(current_activity_ID),this.qsAddSubmitEvent(current_activity_ID,current_exercise_ID,current_question_ID),$("#"+t+" .qs-prevquestion, #"+t+" .qs-nextquestion").removeClass("qs-disabled"),0===this.activities[current_activity_ID].dv.current_exercise_id&&0===this.activities[current_activity_ID].dv.current_question_id&&$("#"+t+" .qs-prevquestion").addClass("qs-disabled"),this.qsComputeProgression(current_activity_ID,"qat")===this.qsComputeProgression(current_activity_ID,"qtot")&&$("#"+t+" .qs-nextquestion").addClass("qs-disabled"),$("#"+t+" .qs-prevquestion, #"+t+" .qs-nextquestion").unbind("click"),$("#"+t+" .qs-prevquestion, #"+t+" .qs-nextquestion").click(function(){$(this).hasClass("qs-disabled")||$(this).hasClass("qs-tmp-disabled")||(fCl("---------------------------- PRESSED NEXT/BACK ----------------------------"),mThis.qsNavQuestions($(this)))}),fQsEvDp("activity_started",{activity_dom_id:t})},this.qsSwitchExercise=function(t,e,s){if(fCl("qsSwitchExercise("+t+" , "+e+" , "+s+")"),(0>e+s||e+1+s>this.activities[t].nb_exercises)&&"branching-score-redirect"!==this.activities[t].exercises[e].exercise_type&&"branching-selective-redirect"!==this.activities[t].exercises[e].exercise_type)return!1;if("branching-score-redirect"===this.activities[t].exercises[e].exercise_type||"branching-selective-redirect"===this.activities[t].exercises[e].exercise_type){if("branching-score-redirect"===this.activities[t].exercises[e].exercise_type){for(exNaturalScore=0,i=0;i<this.activities[t].exercises[e].questions.length;i++)"completed"===this.activities[t].exercises[e].questions[i].dv.status&&(exNaturalScore+=1);exNaturalScore>=this.activities[t].exercises[e].branching_passing_grade?gotoRedirection=this.activities[t].exercises[e].branching_pass_redirection:gotoRedirection=this.activities[t].exercises[e].branching_fail_redirection}else"branching-selective-redirect"===this.activities[t].exercises[e].exercise_type&&(fCl("CHECK IF CORRECT Q TYPE BEFORE GOING ANY FURTHER, SHOULD BE DONE IN PRE LOADING PHASES OR qsValidateSemantic() + CAN'T HAVE RANDOM RIGHT NOW AS THE LAST QUESTION SHOULD ALWAYS BE THE SELECTIVE REDIRECTION ONE"),gotoRedirection=$("#"+this.activities[t].exercises[e].questions[this.activities[t].exercises[e].nb_questions-1].dv.my_answer_id).attr("data-selective-redirection"));if(fCe("CHK:"+gotoRedirection+":"+gotoRedirection.indexOf("f|")),0===gotoRedirection.indexOf("f|"))return qsHide("#"+this.activities[t].id+" .qs-feedback-final .qs-final-branching-feedback"),qsShow("#"+this.activities[t].id+" .qs-feedback-final #"+gotoRedirection.substring(2,gotoRedirection.length)+".qs-final-branching-feedback"),fCe("SHOW -> #"+gotoRedirection.substring(2,gotoRedirection.length)),!1;nextExerciseID=this.qsGetExerciseIDFromStringID(gotoRedirection,t),fCe("Pass ID: "+nextExerciseID),s=nextExerciseID-e}return next_question_id=-1==s?this.activities[t].exercises[e+s].nb_questions-1:0,qsHide("#"+this.activities[t].id+".qs-elearning-activity  #"+this.activities[t].exercises[e+s].id+".qs-exercise .qs-question"),fCl("---------- #"+this.activities[t].id+".qs-elearning-activity  #"+this.activities[t].exercises[e+s].id+".qs-exercise .qs-question"),qsShow("#"+this.activities[t].id+".qs-elearning-activity  #"+this.activities[t].exercises[e+s].id+".qs-exercise #"+this.activities[t].exercises[e+s].questions[next_question_id].id+".qs-question"),fCl("++++++++++ #"+this.activities[t].id+".qs-elearning-activity  #"+this.activities[t].exercises[e+s].id+".qs-exercise #"+this.activities[t].exercises[e+s].questions[next_question_id].id+".qs-question"),qsTransition("#"+this.activities[t].id+".qs-elearning-activity  #"+this.activities[t].exercises[e].id+".qs-exercise","#"+this.activities[t].id+".qs-elearning-activity  #"+this.activities[t].exercises[e+s].id+".qs-exercise"),fCl("--++--++-- #"+this.activities[t].id+".qs-elearning-activity  #"+this.activities[t].exercises[e].id+".qs-exercise, #"+this.activities[t].id+".qs-elearning-activity  #"+this.activities[t].exercises[e+s].id+".qs-exercise"),this.activities[t].dv.current_exercise_id=e+s,this.activities[t].dv.current_question_id=next_question_id,this.activities[t].exercises[e+s].questions[next_question_id].dv.status="unattempted"==this.activities[t].exercises[e+s].questions[next_question_id].dv.status?"incomplete":this.activities[t].exercises[e+s].questions[next_question_id].dv.status,this.activities[t].exercises[e+s].dv.status="unattempted"===this.activities[t].exercises[e+s].dv.status?"incomplete":this.activities[t].exercises[e+s].dv.status,this.qsAddSubmitEvent(t,e+s,next_question_id),$("#"+this.activities[t].id+".qs-elearning-activity  #"+this.activities[t].exercises[e+s].id+".qs-exercise #"+this.activities[t].exercises[e+s].questions[next_question_id].id+".qs-question").find(".qs-continue").attr("disabled",!1).removeClass("qs-disabled"),this.qsComputeParentStatuses(t),this.qsUpdateScoreDisplay(t),!0},this.qsSwitchQuestion=function(t,e){if(fCl("qsSwitchQuestion("+t+","+e+")"),current_activity=this.qsGetActivityIDFromStringID($(t).closest(".qs-elearning-activity").attr("id")),current_exercise=this.activities[current_activity].dv.current_exercise_id,current_question=this.activities[current_activity].dv.current_question_id,nb_total_questions=this.qsComputeProgression(current_activity,"qtot"),$("#"+$(t).closest(".qs-elearning-activity").attr("id")+" .qs-finallinkto-unanswered").remove(),qsHide("#"+this.activities[ancestryIDARR[0]].id+" .qs-finallinkto-unanswered-placeholder"),0>=e||e>nb_total_questions)return fCe("look's like you're going nowhere!(out of bounds)"),!1;for(fCl("current_exercise:"+current_exercise+"  |current_question:"+current_question+"  |nb_questions_total:"+nb_total_questions),qAt=0,qChecker=0,target_exercise=-1,target_question=-1,target_exercise_STRID="",qMatrixArr=[],i=0;i<this.activities[current_activity].nb_exercises;i++)qMatrixArr[i]=this.activities[current_activity].exercises[i].nb_questions,qAt+=this.activities[current_activity].exercises[i].nb_questions,e-1<qAt&&""===target_exercise_STRID&&(target_exercise=i,target_exercise_STRID=this.activities[current_activity].exercises[i].id);for(i=0;i<target_exercise;i++)qChecker+=qMatrixArr[i];target_question=e-1-qChecker,current_exercise==target_exercise?qsTransition("#"+this.activities[current_activity].exercises[current_exercise].questions[current_question].id,"#"+this.activities[current_activity].exercises[current_exercise].questions[target_question].id):(qsHide("#"+target_exercise_STRID+" .qs-question"),qsShow("#"+target_exercise_STRID+" #"+this.activities[current_activity].exercises[target_exercise].questions[target_question].id),qsTransition("#"+this.activities[current_activity].exercises[current_exercise].id,"#"+this.activities[current_activity].exercises[target_exercise].id)),this.activities[current_activity].dv.current_exercise_id=target_exercise,this.activities[current_activity].dv.current_question_id=target_question,$("#"+$(t).closest(".qs-elearning-activity").attr("id")).find(".qs-prevquestion, .qs-nextquestion").removeClass("qs-disabled"),0===target_exercise&&0===target_question?$("#"+$(t).closest(".qs-elearning-activity").attr("id")).find(".qs-prevquestion").addClass("qs-disabled"):e===nb_total_questions&&$("#"+$(t).closest(".qs-elearning-activity").attr("id")).find(".qs-nextquestion").addClass("qs-disabled"),this.qsUpdateScoreDisplay(current_activity),fCe("target_exercise:"+target_exercise+"  |target_question:"+target_question+"  |question_total_at:"+e)},this.qsNavQuestions=function(t){return fCl("qsNavQuestions()"),current_activity=this.qsGetActivityIDFromStringID($(t).closest(".qs-elearning-activity").attr("id")),current_exercise_ID=this.activities[current_activity].dv.current_exercise_id,current_question_ID=this.activities[current_activity].dv.current_question_id,0===this.activities[current_activity].dv.current_exercise_id&&0===this.activities[current_activity].dv.current_question_id&&$(t).hasClass("qs-prevquestion")?(fCl("cannot go back!"),!1):this.activities[current_activity].question_skipping_enabled||!$(t).hasClass("qs-nextquestion")||"unattempted"!=this.activities[current_activity].exercises[current_exercise_ID].questions[current_question_ID].dv.status&&"incomplete"!=this.activities[current_activity].exercises[current_exercise_ID].questions[current_question_ID].dv.status?($("#"+this.activities[current_activity].id).find(".qs-prevquestion, .qs-nextquestion").addClass("qs-tmp-disabled"),setTimeout(function(){$("#"+$(t).closest(".qs-elearning-activity").attr("id")).find(".qs-prevquestion, .qs-nextquestion").removeClass("qs-tmp-disabled")},this.settings.animBaseDuration+150),void($(t).hasClass("qs-prevquestion")?this.qsNextQuestion("#"+this.activities[current_activity].exercises[current_exercise_ID].questions[current_question_ID].id,-1):$(t).hasClass("qs-nextquestion")&&this.qsNextQuestion("#"+this.activities[current_activity].exercises[current_exercise_ID].questions[current_question_ID].id,1))):(fCl("Cant go to the next question without answering the current first, please answer current question or contact your nextwork administrator"),alert(this.msgs.msgQuestionUnanswered),!1)},this.qsNextQuestion=function(elem,qOffset,excpt){fCl("qsNextQuestion("+elem+","+qOffset+","+excpt+")"),qOffset=void 0==qOffset?1:qOffset,ancestryIDARR=this.qsGetAncestryIDS(elem),current_exercise=this.activities[ancestryIDARR[0]].dv.current_exercise_id,current_question=this.activities[ancestryIDARR[0]].dv.current_question_id,nb_question=this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].nb_questions,$("#"+this.activities[ancestryIDARR[0]].id+" .qs-finallinkto-unanswered").remove(),"final-submit"!==excpt?(eval(this.qsComputeProgression(ancestryIDARR[0],"qat"))+qOffset===1?$("#"+this.activities[ancestryIDARR[0]].id+" .qs-prevquestion").addClass("qs-disabled"):$("#"+this.activities[ancestryIDARR[0]].id+" .qs-prevquestion").removeClass("qs-disabled"),eval(this.qsComputeProgression(ancestryIDARR[0],"qat")+qOffset)>=eval(this.qsComputeProgression(ancestryIDARR[0],"qtot"))?$("#"+this.activities[ancestryIDARR[0]].id+" .qs-nextquestion").addClass("qs-disabled"):$("#"+this.activities[ancestryIDARR[0]].id+" .qs-nextquestion").removeClass("qs-disabled")):(current_exercise=current_exercise,
current_question=current_question),$(elem).closest(".qs-feedback").find(".qs-continue").attr("disabled",!0).addClass("qs-disabled"),this.activities[ancestryIDARR[0]].submit_all_at_once&&eval(this.qsComputeProgression(ancestryIDARR[0],"qat")+1)==eval(this.qsComputeProgression(ancestryIDARR[0],"qtot"))&&1===qOffset&&($("#"+this.activities[ancestryIDARR[0]].id).find(".qs-submit-activity").length||($("#"+this.activities[ancestryIDARR[0]].id+" .qs-final-submit-placeholder").length?$("#"+this.activities[ancestryIDARR[0]].id+" .qs-final-submit-placeholder").append(this.objDefVal.domButtons.qs_submit_activity):$("#"+this.activities[ancestryIDARR[0]].exercises[this.activities[ancestryIDARR[0]].nb_exercises-1].questions[this.activities[ancestryIDARR[0]].exercises[this.activities[ancestryIDARR[0]].nb_exercises-1].nb_questions-1].id).find(".qs-answers").append(this.objDefVal.domButtons.qs_submit_activity),$("#"+this.activities[ancestryIDARR[0]].id).find(".qs-submit-activity").attr("data-passthrough",this.activities[ancestryIDARR[0]].exercises[this.activities[ancestryIDARR[0]].nb_exercises-1].questions[this.activities[ancestryIDARR[0]].exercises[this.activities[ancestryIDARR[0]].nb_exercises-1].nb_questions-1].id)),$("#"+this.activities[ancestryIDARR[0]].id).find(".qs-submit-activity").unbind("click"),$("#"+this.activities[ancestryIDARR[0]].id).find(".qs-submit-activity").click(function(){$(this).hasClass("qs-disabled")||(fCl("---------------------------- PRESSED FINAL ACTIVITY SUBMIT ----------------------------"),mThis.qsAnswerQuestion($("#"+$(this).attr("data-passthrough")),"final-submit"))})),current_question+qOffset>=nb_question||current_question+qOffset<0?(fCl("Going outside of current exercise: "+current_question+"+"+qOffset+"="+(current_question+qOffset)),this.qsMarkExerciseDone(ancestryIDARR[0],current_exercise),this.qsSwitchExercise(ancestryIDARR[0],ancestryIDARR[1],qOffset)||(fCl("cant switch to an exercise that doesn exist"),qOffset>0&&this.qsActivityCompleted(elem))):(fQsEvDp("question_navigation",{activity_dom_id:this.activities[ancestryIDARR[0]].id,direction:qOffset}),this.activities[ancestryIDARR[0]].dv.current_question_id=current_question+qOffset,this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[current_question+qOffset].dv.status="unattempted"==this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[current_question+qOffset].dv.status?"incomplete":this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[current_question+qOffset].dv.status,this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].dv.status="unattempted"===this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].dv.status?"incomplete":this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].dv.status,this.qsComputeParentStatuses(ancestryIDARR[0]),qsTransition("#"+this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[current_question].id,"#"+this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[current_question+qOffset].id),ancestrySTRARR=this.qsGetAncestryStringIDS($("#"+this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[current_question+qOffset].id)),this.qsAddSubmitEvent(ancestryIDARR[0],ancestryIDARR[1],current_question+qOffset),$("#"+ancestrySTRARR[0]+" #"+ancestrySTRARR[1]+".qs-exercise #"+ancestrySTRARR[2]+".qs-question").find(".qs-continue").attr("disabled",!1).removeClass("qs-disabled"),this.activities[ancestryIDARR[0]].auto_scroll_to_question&&$("html, body").animate({scrollTop:$("#"+ancestrySTRARR[0]).offset().top},20)),this.qsUpdateScoreDisplay(current_activity_ID),fFocus("#"+ancestrySTRARR[2]+".qs-question")},this.qsAnswerQuestion=function(t,e){fCl("qsAnswerQuestion("+t+" (#"+$(t).attr("id")+"),"+e+")");var s;switch(ancestryIDARR=this.qsGetAncestryIDS(t),question_type=this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].question_type,e=void 0===e?"default":e,answerStatus="",secondChanceNeeded=!1,this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].persistent_vsfb||$(t).closest(".qs-question").find(".qs-vsfbh").html(""),question_type){case"type-0":if(fCe("type-0: Needs to replace reserved chars...right now it doesnt...catastrophic failure can and will happen! FIX ME"),right_answer=!0,$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find("textarea").each(function(){""!==$(this).val()&&void 0!==$(this).val()&&""!==$(this).val().trim()||(right_answer=!1)}),!right_answer)return"final-submit-all-at-once"!==e&&alert(this.msgs.msgEmptyTextField),!1;right_answer=!0,answerStatus="right",("final-submit-all-at-once"!=e&&"final-submit"!=e||this.activities[ancestryIDARR[0]].submit_aao_disable_right_anwers)&&("simple"===this.activities[ancestryIDARR[0]].activity_type&&"never"===this.activities[ancestryIDARR[0]].simple_act_disable_mode||$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find("textarea").attr("disabled",!0)),a=[],$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find("textarea").each(function(){$(this).val(mThis.qsValidateChars($(this).val())),a.push($(this).attr("id")+qSplt[0]+$(this).val())}),this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].dv.my_answer_id=a.join(qSplt[1]);break;case"type-1":if($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="radio"]:checked').length<=0)return"final-submit-all-at-once"!==e&&alert(this.msgs.msgNoSelection),!1;if(s=this.settings.encodeAnswers?this.qsTestAgainstEncodedValidationString("gonogo",$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="radio"]:checked').attr("data-encoded-rep")):$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="radio"]:checked').hasClass("ra"))answerStatus="right",("final-submit-all-at-once"!=e&&"final-submit"!=e||this.activities[ancestryIDARR[0]].submit_aao_disable_right_anwers)&&("simple"===this.activities[ancestryIDARR[0]].activity_type&&"never"===this.activities[ancestryIDARR[0]].simple_act_disable_mode||($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="radio"]').attr("disabled",!0),$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).parent().find("input.qs-submit").attr("disabled",!0)));else{if(answerStatus="wrong",this.qsManageSecondChance(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].id)){secondChanceNeeded=!0;break}("final-submit-all-at-once"!=e&&"final-submit"!=e||this.activities[ancestryIDARR[0]].submit_aao_disable_right_anwers)&&("simple"!==this.activities[ancestryIDARR[0]].activity_type||"never"!==this.activities[ancestryIDARR[0]].simple_act_disable_mode&&"onright"!==this.activities[ancestryIDARR[0]].simple_act_disable_mode)&&$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="radio"]').attr("disabled",!0)}for(qsShow($("#"+this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].id+" .qs-feedback .qs-specific[data-specific-feedback-target="+$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].elem).find('input[type="radio"]:checked').attr("id")+"]")),vsfbhi=0;vsfbhi<$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="radio"]:checked').length;vsfbhi++)tElem=this.qsGetClosestMatch(".qs-vsfbh",$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="radio"]:checked')[vsfbhi].id),s=this.settings.encodeAnswers?this.qsTestAgainstEncodedValidationString("gonogo",$($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="radio"]:checked')[vsfbhi]).attr("data-encoded-rep")):$($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="radio"]:checked')[vsfbhi]).hasClass("ra"),s?$(tElem).html(this.objDefVal.domVisuals.positive_feedback):$(tElem).html(this.objDefVal.domVisuals.negative_feedback);qsShow("#"+this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].id+" .qs-vsfbh"),this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].dv.my_answer_id=$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="radio"]:checked').attr("id");break;case"type-2":if($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="checkbox"]:checked').length<=0&&!this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].empty_allowed)return"final-submit-all-at-once"!==e&&alert(this.msgs.msgNoMultiSelection),!1;if(right_answer=!0,$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="checkbox"]').each(function(){return s=mThis.settings.encodeAnswers?mThis.qsTestAgainstEncodedValidationString("gonogo",$(this).attr("data-encoded-rep"))!=$(this).prop("checked"):$(this).hasClass("ra")!=$(this).prop("checked"),s?(right_answer=!1,!1):void 0}),right_answer)answerStatus="right",("final-submit-all-at-once"!=e&&"final-submit"!=e||this.activities[ancestryIDARR[0]].submit_aao_disable_right_anwers)&&("simple"===this.activities[ancestryIDARR[0]].activity_type&&"never"===this.activities[ancestryIDARR[0]].simple_act_disable_mode||$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="checkbox"]').attr("disabled",!0));else{if(answerStatus="wrong",this.qsManageSecondChance(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].id)){secondChanceNeeded=!0;break}("final-submit-all-at-once"!=e&&"final-submit"!=e||this.activities[ancestryIDARR[0]].submit_aao_disable_right_anwers)&&("simple"!==this.activities[ancestryIDARR[0]].activity_type||"never"!==this.activities[ancestryIDARR[0]].simple_act_disable_mode&&"onright"!==this.activities[ancestryIDARR[0]].simple_act_disable_mode)&&$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="checkbox"]').attr("disabled",!0)}for($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].elem).find('input[type="checkbox"]:checked').each(function(){qsShow($("#"+mThis.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].id+" .qs-feedback .qs-specific[data-specific-feedback-target="+$(this).attr("id")+"]"))}),vsfbhi=0;vsfbhi<$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="checkbox"]').length;vsfbhi++)tElem=this.qsGetClosestMatch(".qs-vsfbh",$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="checkbox"]')[vsfbhi].id),s=this.settings.encodeAnswers?this.qsTestAgainstEncodedValidationString("gonogo",$($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="checkbox"]')[vsfbhi]).attr("data-encoded-rep")):$($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="checkbox"]')[vsfbhi]).hasClass("ra"),s?$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="checkbox"]')[vsfbhi].checked?$(tElem).html(this.objDefVal.domVisuals.positive_feedback):$(tElem).html(this.objDefVal.domVisuals.negative_feedback):$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="checkbox"]')[vsfbhi].checked?$(tElem).html(this.objDefVal.domVisuals.negative_feedback):$(tElem).html(this.objDefVal.domVisuals.positive_feedback);for(qsShow("#"+this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].id+" .qs-vsfbh"),a=[],i=0;i<$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="checkbox"]:checked').length;i++)a.push($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="checkbox"]:checked').eq(i).attr("id"));this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].dv.my_answer_id=$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="checkbox"]:checked').length<1?"":a.join(",");break;case"type-3":if(tfEmpty=!1,$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="text"]').each(function(){""!=$(this).val()&&void 0!=$(this).val()||(tfEmpty=!0)}),tfEmpty)return"final-submit-all-at-once"!==e&&alert(this.msgs.msgEmptyTextField),!1;if(right_answer=!0,$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="text"]').each(function(){var t=$(this).val(),e=mThis.settings.encodeAnswers?mThis.qsTestAgainstEncodedValidationString("encrypt",$(this).attr("data-encoded-rep")):$(this).attr("data-rep"),i=mThis.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].ignore_case;if(i&&(t=t.toLowerCase(),e=e.toLowerCase()),e.split("|").length>1){fCl('Test against "|" other reserved chars');var s;for(tmp_right_answer=!1,s=0;s<e.split("|").length;s++)if(t==e.split("|")[s]){tmp_right_answer=!0;break}tmp_right_answer?$(this).addClass("qs_good_answer"):(right_answer=!1,$(this).addClass("qs_wrong_answer"))}else t!=e?(right_answer=!1,$(this).addClass("qs_wrong_answer")):$(this).addClass("qs_good_answer")}),right_answer)answerStatus="right",("final-submit-all-at-once"!=e&&"final-submit"!=e||this.activities[ancestryIDARR[0]].submit_aao_disable_right_anwers)&&("simple"===this.activities[ancestryIDARR[0]].activity_type&&"never"===this.activities[ancestryIDARR[0]].simple_act_disable_mode||$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="text"]').attr("disabled",!0));else{if(answerStatus="wrong",this.qsManageSecondChance(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].id)){secondChanceNeeded=!0;break}("final-submit-all-at-once"!=e&&"final-submit"!=e||this.activities[ancestryIDARR[0]].submit_aao_disable_right_anwers)&&("simple"!==this.activities[ancestryIDARR[0]].activity_type||"never"!==this.activities[ancestryIDARR[0]].simple_act_disable_mode&&"onright"!==this.activities[ancestryIDARR[0]].simple_act_disable_mode)&&$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="text"]').attr("disabled",!0)}for(vsfbhi=0;vsfbhi<$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="text"]').length;vsfbhi++)tElem=this.qsGetClosestMatch(".qs-vsfbh",$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="text"]')[vsfbhi].id),$($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="text"]')[vsfbhi]).hasClass("qs_good_answer")?$(tElem).html(this.objDefVal.domVisuals.positive_feedback):$(tElem).html(this.objDefVal.domVisuals.negative_feedback);qsShow("#"+this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].id+" .qs-vsfbh");var a=[];for(i=0;i<$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="text"]').length;i++)$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="text"]').eq(i).val(this.qsValidateChars($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="text"]').eq(i).val())),a.push($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="text"]').eq(i).attr("id")+qSplt[0]+$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="text"]').eq(i).val());this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].dv.my_answer_id=a.join(qSplt[1]);break;case"type-4":if(dDEmpty=!1,dDDuplicateArr=[],dDAnswerArr=[],$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find("select").each(function(){null!==$(this).val()&&0!=$(this).val()||(dDEmpty=!0),dDAnswerArr.push([$(this).attr("id"),$(this).attr("data-rep")===$(this).val(),$(this).val()]),dDDuplicateArr.push($(this).val())}),dDEmpty)return"final-submit-all-at-once"!==e&&alert(this.msgs.msgEmptyDropDown),!1;if(0==this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].allow_duplicate_answer&&$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find("select").length>0){dDDuplicateSel=!1,dDDuplicateArr.sort();for(i in dDDuplicateArr)dDDuplicateArr[i]===dDDuplicateArr[i-1]&&(dDDuplicateSel=!0);if(dDDuplicateSel)return"final-submit-all-at-once"!==e&&alert(this.msgs.msgDuplicateDropDown),!1}for(right_answer=!0,i=0;i<dDAnswerArr.length;i++)dDAnswerArr[i][1]||(right_answer=!1),tElem=this.qsGetClosestMatch(".qs-vsfbh",dDAnswerArr[i][0]),dDAnswerArr[i][1]?$(tElem).html(this.objDefVal.domVisuals.positive_feedback):$(tElem).html(this.objDefVal.domVisuals.negative_feedback),qsShow($("#"+dDAnswerArr[i][0]).closest(".qs-answers").find(".qs-vsfbh"));if(right_answer)answerStatus="right";else if(answerStatus="wrong",this.qsManageSecondChance(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].id)){secondChanceNeeded=!0;break}for(i in dDAnswerArr)("final-submit-all-at-once"!=e&&"final-submit"!=e||this.activities[ancestryIDARR[0]].submit_aao_disable_right_anwers)&&("simple"===this.activities[ancestryIDARR[0]].activity_type&&"never"===this.activities[ancestryIDARR[0]].simple_act_disable_mode||("simple"===this.activities[ancestryIDARR[0]].activity_type&&"onright"===this.activities[ancestryIDARR[0]].simple_act_disable_mode?"right"===answerStatus?$("select#"+dDAnswerArr[i][0]).prop("disabled","disabled"):dDAnswerArr.length>1&&dDAnswerArr[i][1]&&$("#"+dDAnswerArr[i][0]).prop("disabled","disabled"):$("select#"+dDAnswerArr[i][0]).prop("disabled","disabled"))),void 0!==$("#"+dDAnswerArr[i][0]).attr("data-specific-negative-feedback")&&dDAnswerArr[i][1]===!1&&qsShow($("#"+$("#"+dDAnswerArr[i][0]).attr("data-specific-negative-feedback"))),void 0!==$("#"+dDAnswerArr[i][0]).attr("data-specific-positive-feedback")&&dDAnswerArr[i][1]===!0&&qsShow($("#"+$("#"+dDAnswerArr[i][0]).attr("data-specific-positive-feedback")));var a=[];for(i in dDAnswerArr)a.push(dDAnswerArr[i][0]+qSplt[0]+dDAnswerArr[i][2]);this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].dv.my_answer_id=a.join(qSplt[1]);break;case"type-5":if(s=this.settings.encodeAnswers?this.qsTestAgainstEncodedValidationString("gonogo",$(t).attr("data-encoded-rep")):$(t).hasClass("ra"))answerStatus="right",("final-submit-all-at-once"!=e&&"final-submit"!=e||this.activities[ancestryIDARR[0]].submit_aao_disable_right_anwers)&&("simple"===this.activities[ancestryIDARR[0]].activity_type&&"never"===this.activities[ancestryIDARR[0]].simple_act_disable_mode||$(t).closest(".qs-answers").find("input[type=button]").attr("disabled",!0));else{if(answerStatus="wrong",this.qsManageSecondChance(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].id)){secondChanceNeeded=!0;break}("final-submit-all-at-once"!=e&&"final-submit"!=e||this.activities[ancestryIDARR[0]].submit_aao_disable_right_anwers)&&("simple"!==this.activities[ancestryIDARR[0]].activity_type||"never"!==this.activities[ancestryIDARR[0]].simple_act_disable_mode&&"onright"!==this.activities[ancestryIDARR[0]].simple_act_disable_mode)&&$(t).closest(".qs-answers").find("input[type=button]").attr("disabled",!0)}for(qsShow($("#"+this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].id+" .qs-feedback .qs-specific[data-specific-feedback-target="+$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].elem).find('input[type="radio"]:checked').attr("id")+"]")),vsfbhi=0;vsfbhi<$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="button"]').length;vsfbhi++)$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="button"]')[vsfbhi].id===$(t).attr("id")?$($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="button"]')[vsfbhi]).addClass("qs-answered"):$($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="button"]')[vsfbhi]).addClass("qs-unanswered");for(fCe("type-5 → test for highlite all mode..."),vsfbhi=0;vsfbhi<$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="button"][id="'+$(t).attr("id")+'"]').length;vsfbhi++)tElem=this.qsGetClosestMatch(".qs-vsfbh",$(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="button"][id="'+$(t).attr("id")+'"]')[vsfbhi].id),s=this.settings.encodeAnswers?this.qsTestAgainstEncodedValidationString("gonogo",$($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="button"][id="'+$(t).attr("id")+'"]')[vsfbhi]).attr("data-encoded-rep")):$($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].answers.elem).find('input[type="button"][id="'+$(t).attr("id")+'"]')[vsfbhi]).hasClass("ra"),s?$(tElem).html(this.objDefVal.domVisuals.positive_feedback):$(tElem).html(this.objDefVal.domVisuals.negative_feedback);qsShow("#"+this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].id+" .qs-vsfbh"),this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].dv.my_answer_id=$(t).attr("id");break;default:fCe("qsAnswerQuestion: unknown question type...")}fCl("Answer(s) validated!"),"right"===answerStatus?(qsShow($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].elem).find(".qs-feedback .qs-right, .qs-feedback .qs-generic")),qsHide($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].elem).find(".qs-feedback .qs-wrong")),$(t).closest(".qs-question").attr("data-status","completed"),this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].dv.status="completed"):"wrong"===answerStatus&&(secondChanceNeeded?(qsHide($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].elem).find(".qs-feedback .qs-wrong, .qs-feedback .qs-right, .qs-feedback .qs-generic")),qsShow($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].elem).find(".qs-feedback .qs-second-chance"))):(qsShow($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].elem).find(".qs-feedback .qs-wrong, .qs-feedback .qs-generic")),qsHide($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].elem).find(".qs-feedback .qs-right")),$(t).closest(".qs-question").attr("data-status","failed"),this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].dv.status="failed")),secondChanceNeeded?(qsFadeIn($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].elem).find(".qs-feedback")),fFocus($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].elem).find(".qs-feedback"))):(qsHide($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].elem).find(".qs-feedback .qs-second-chance")),"simple"===this.activities[ancestryIDARR[0]].activity_type&&("right"===answerStatus&&"never"===this.activities[ancestryIDARR[0]].simple_act_disable_mode||"wrong"===answerStatus&&("onright"===this.activities[ancestryIDARR[0]].simple_act_disable_mode||"never"===this.activities[ancestryIDARR[0]].simple_act_disable_mode))?fCe("Nothing here...normal?"):$(t).closest(".qs-answers").find(".qs-submit").unbind().attr("disabled",!0).addClass("qs-disabled"),this.qsComputeParentStatuses(ancestryIDARR[0]),this.qsUpdateScoreDisplay(ancestryIDARR[0]),questionFeedbackType=this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].feedback_type,"deferred"==questionFeedbackType||"none"==questionFeedbackType?"default"===e?(this.qsNextQuestion(t),fCl("DEFAULT")):"final-submit"===e&&(this.qsNextQuestion(t,123456,"final-submit"),fCe('*WIP !IMPORTANT! PLEASE FIX FORCED HARDCODED INTEGER "123456"!!!')):"instant"==questionFeedbackType&&(A=!$(t).closest(".qs-question").find(".qs-continue").length,B="simple"!=this.activities[ancestryIDARR[0]].activity_type,C=$(this.activities[ancestryIDARR[0]].elem).find(".qs-feedback-final").length,D=this.qsComputeProgression(ancestryIDARR[0],"qat")!==this.qsComputeProgression(ancestryIDARR[0],"qtot"),A&&B&&(C||D)&&(C&&!D?this.activities[ancestryIDARR[0]].force_insert_final_submit&&($("#"+this.activities[ancestryIDARR[0]].id).find(".qs-final-submit-placeholder").html(this.objDefVal.domButtons.qs_submit_activity),$("#"+this.activities[ancestryIDARR[0]].id).find(".qs-submit-activity").attr("data-pass-id",this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].id),$("#"+this.activities[ancestryIDARR[0]].id).find(".qs-submit-activity").unbind("click"),$("#"+this.activities[ancestryIDARR[0]].id).find(".qs-submit-activity").click(function(){$(this).hasClass("qs-disabled")||(fCl("---------------------------- PRESSED CONTINUE FROM FEEDBACK BOX AFTER ANSWERING QUESTION (CREATED VIA qsAnswerQuestion()) ----------------------------"),mThis.qsNextQuestion($("#"+$(this).attr("data-pass-id")),1,"final-submit"))})):$(t).closest(".qs-question").find(".qs-feedback").append(this.objDefVal.domButtons.qs_continue)),qsFadeIn($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].elem).find(".qs-feedback")),fFocus($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].elem).find(".qs-feedback")),$(t).closest(".qs-question").find(".qs-continue").unbind("click"),$(t).closest(".qs-question").find(".qs-continue").click(function(){$(this).hasClass("qs-disabled")||(fCl("---------------------------- PRESSED CONTINUE FROM FEEDBACK BOX AFTER ANSWERING QUESTION (CREATED VIA qsAnswerQuestion()) ----------------------------"),mThis.qsNextQuestion(this))})),fQsEvDp("question_answered",{activity_dom_id:this.activities[ancestryIDARR[0]].id,answer_status:answerStatus}))},this.qsMarkExerciseDone=function(t,e){if(fCl("qsMarkExerciseDone()"),"completed"==this.activities[t].exercises[e].dv.status||"failed"==this.activities[t].exercises[e].dv.status)return!1;for(allGood=!0,i=0;i<this.activities[t].exercises[e].nb_questions;i++)if("completed"!=this.activities[t].exercises[e].questions[i].dv.status&&"failed"!=this.activities[t].exercises[e].questions[i].dv.status){allGood=!1;break}if(allGood){for($("#"+this.activities[t].exercises[e].id+".qs-question").attr("data-status","completed"),this.activities[t].exercises[e].dv.status="completed",allGood_b=!0,i=0;i<this.activities[t].nb_exercises;i++)if("completed"!=this.activities[t].exercises[i].dv.status){allGood_b=!1;break}allGood_b&&($("#"+this.activities[t].id+".qs-question").attr("data-status","completed"),this.activities[t].dv.status="completed")}this.qsComputeParentStatuses(t)},this.qsActivityCompleted=function(t){if(fCl("qsActivityCompleted()"),ancestryIDARR=this.qsGetAncestryIDS(t),this.activities[ancestryIDARR[0]].submit_all_at_once){var e,i,s;for(e=0;e<this.activities.length;e++)for(i=0;i<this.activities[e].exercises.length;i++)for(s=0;s<this.activities[e].exercises[i].questions.length;s++)"failed"===this.activities[e].exercises[i].questions[s].dv.status&&"completed"===this.activities[e].exercises[i].questions[s].dv.status||this.qsAnswerQuestion(this.activities[e].exercises[i].questions[s].elem,"final-submit-all-at-once")}if(this.activities[ancestryIDARR[0]].trigger_course_completion){if(fCe("COURSE COMPLETION VALIDATION:"+this.qsComputeActivityScore(ancestryIDARR[0],"perc")+"% ("+this.activities[ancestryIDARR[0]].trigger_completion_score+"% OR MORE NEEDED TO GRADUATE)\nCOURSE COMPLETION TRIGGER IS CURRENTLY INCOMPLETE AND WILL NOT SAVE ANYTHING TO THE LMS"),this.qsComputeActivityScore(ancestryIDARR[0],"perc")>=this.activities[ancestryIDARR[0]].trigger_completion_score){fCl("TRIGGER COURSE COMPLETION!");try{scorm.complete()}catch(a){fCe(a.message)}}}else fCl("ACTIVITY COMPLETED: NO SCORM TRIGGERING");if(!$("#"+this.activities[ancestryIDARR[0]].id+".qs-elearning-activity .qs-feedback-final").length&&!this.activities[ancestryIDARR[0]].recap_required)return this.qsSaveData(ancestryIDARR[0]),!0;if(fCl("RECREATE MISSING .qs-feedback-final + qs-recap-template + buttons....*WIP"),"branching"!==this.activities[ancestryIDARR[0]].activity_type){var e,i,s,r=!0,n=[],c=0;for(i=0;i<this.activities[ancestryIDARR[0]].exercises.length;i++)for(s=0;s<this.activities[ancestryIDARR[0]].exercises[i].questions.length;s++)c+=1,"completed"!==this.activities[ancestryIDARR[0]].exercises[i].questions[s].dv.status&&"failed"!==this.activities[ancestryIDARR[0]].exercises[i].questions[s].dv.status&&(n.push(c+","+i+","+s),r=!1);if(!r){alert(this.msgs.msgActivityNotCompleted),$("#"+this.activities[ancestryIDARR[0]].id+" .qs-finallinkto-unanswered").remove(),linksBuffer='<div class="qs-finallinkto-unanswered"><ul>';var e;for(e=0;e<n.length;e++)linksBuffer+='<li><a href="javascript:;" onClick="javascript:'+objAcc+".qsSwitchQuestion('#"+$(t).closest(".qs-question").attr("id")+"',"+n[e].split(",")[0]+');return false;">'+this.msgs.msgUnanweredQuestionGotoPrefix+n[e].split(",")[0]+this.msgs.msgUnanweredQuestionGotoSuffix+"</a></li>";return linksBuffer+="</ul></div>",$("#"+this.activities[ancestryIDARR[0]].id+" .qs-finallinkto-unanswered-placeholder").length?$("#"+this.activities[ancestryIDARR[0]].id+" .qs-finallinkto-unanswered-placeholder").append(linksBuffer):$("#"+this.activities[ancestryIDARR[0]].id+" .qs-submit-activity").after(linksBuffer),qsShow("#"+this.activities[ancestryIDARR[0]].id+" .qs-finallinkto-unanswered-placeholder"),!1}}qsHide($("#"+this.activities[ancestryIDARR[0]].id+" .qs-question")),qsHide($("#"+this.activities[ancestryIDARR[0]].id+" .qs-exercise")),$("#"+this.activities[ancestryIDARR[0]].id+" .qs-finallinkto-unanswered-placeholder").remove(),$("#"+this.activities[ancestryIDARR[0]].id+" .qs-submit-activity").remove(),$("#"+this.activities[ancestryIDARR[0]].id+" .qs-question").find('textarea, input[type="radio"], input[type="checkbox"], input[type="text"]').attr("disabled",!0),
$("#"+this.activities[ancestryIDARR[0]].id+" .qs-question").find("select").prop("disabled","disabled"),$("#"+this.activities[ancestryIDARR[0]].id+".qs-elearning-activity").removeClass("qs-step1 qs-step2").addClass("qs-step3");var o=$("#"+this.activities[ancestryIDARR[0]].id+" .qs-feedback-final .qs-recap-template");if($(o).find(".qs-recap-item").remove(),this.activities[ancestryIDARR[0]].recap_required&&$(o).length){fCl("recap required - add in validation a checker for qs-recap-template");var e,i,s,d=0;for(fCl("currently not ready for multiple activities on page (loose selectors) *TMP"),e=0;e<this.activities[ancestryIDARR[0]].exercises.length;e++)for(i=0;i<this.activities[ancestryIDARR[0]].exercises[e].questions.length;i++){switch(d++,appendBuffer="",recapItemID="qs-recap-item-"+this.activities[ancestryIDARR[0]].exercises[e].questions[i].id,appendBuffer+="<div class='qs-post-question'>"+$(this.activities[ancestryIDARR[0]].exercises[e].questions[i].elem).find(".qs-text").html()+"</div>",this.activities[ancestryIDARR[0]].exercises[e].questions[i].question_type){case"type-0":for(appendBuffer+="<div class='qs-post-answers'>"+this.msgs.msgFeedbackRecallAnswerPrefix,s=0;s<this.activities[ancestryIDARR[0]].exercises[e].questions[i].dv.my_answer_id.split(qSplt[1]).length;s++)appendBuffer+=this.activities[ancestryIDARR[0]].exercises[e].questions[i].dv.my_answer_id.split(qSplt[1])[s].split(qSplt[0])[1]+(this.activities[ancestryIDARR[0]].exercises[e].questions[i].dv.my_answer_id.split(qSplt[1]).length===s+1?"":", ");appendBuffer+="</div>";break;case"type-1":appendBuffer+="<div class='qs-post-answers'>"+this.msgs.msgFeedbackRecallAnswerPrefix+$("label[for="+this.activities[ancestryIDARR[0]].exercises[e].questions[i].dv.my_answer_id+"]").text()+"</div>";break;case"type-2":if(appendBuffer+="<div class='qs-post-answers'>",""!==this.activities[ancestryIDARR[0]].exercises[e].questions[i].dv.my_answer_id&&void 0!==this.activities[ancestryIDARR[0]].exercises[e].questions[i].dv.my_answer_id)for(appendBuffer+=this.msgs.msgFeedbackRecallAnswerPrefix,s=0;s<this.activities[ancestryIDARR[0]].exercises[e].questions[i].dv.my_answer_id.split(",").length;s++)appendBuffer+=$("label[for="+this.activities[ancestryIDARR[0]].exercises[e].questions[i].dv.my_answer_id.split(",")[s]+"]").text()+(this.activities[ancestryIDARR[0]].exercises[e].questions[i].dv.my_answer_id.split(",").length===s+1?"":", ");else appendBuffer+=this.msgs.msgFeedbackRecallNoAnswerPrefix;appendBuffer+="</div>";break;case"type-3":for(appendBuffer+="<div class='qs-post-answers'>"+this.msgs.msgFeedbackRecallAnswerPrefix,s=0;s<this.activities[ancestryIDARR[0]].exercises[e].questions[i].dv.my_answer_id.split(qSplt[1]).length;s++)appendBuffer+=this.activities[ancestryIDARR[0]].exercises[e].questions[i].dv.my_answer_id.split(qSplt[1])[s].split(qSplt[0])[1]+(this.activities[ancestryIDARR[0]].exercises[e].questions[i].dv.my_answer_id.split(qSplt[1]).length===s+1?"":", ");appendBuffer+="</div>";break;case"type-4":for(appendBuffer+="<div class='qs-post-answers'>"+this.msgs.msgFeedbackRecallAnswerPrefix,s=0;s<this.activities[ancestryIDARR[0]].exercises[e].questions[i].dv.my_answer_id.split(qSplt[1]).length;s++)appendBuffer+=$("#"+this.activities[ancestryIDARR[0]].exercises[e].questions[i].dv.my_answer_id.split(qSplt[1])[s].split(qSplt[0])[0]).find("option[value="+this.activities[ancestryIDARR[0]].exercises[e].questions[i].dv.my_answer_id.split(qSplt[1])[s].split(qSplt[0])[1]+"]").text(),void 0!==$("#"+this.activities[ancestryIDARR[0]].exercises[e].questions[i].dv.my_answer_id.split(qSplt[1])[s].split(qSplt[0])[0]).attr("data-recap-text")?appendBuffer+=": "+$("#"+this.activities[ancestryIDARR[0]].exercises[e].questions[i].dv.my_answer_id.split(qSplt[1])[s].split(qSplt[0])[0]).attr("data-recap-text"):void 0!==$("#"+this.activities[ancestryIDARR[0]].exercises[e].questions[i].dv.my_answer_id.split(qSplt[1])[s].split(qSplt[0])[0]).attr("data-recap-label")&&(appendBuffer+=": "+$("#"+$("#"+this.activities[ancestryIDARR[0]].exercises[e].questions[i].dv.my_answer_id.split(qSplt[1])[s].split(qSplt[0])[0]).attr("data-recap-label")).text()),appendBuffer+=this.activities[ancestryIDARR[0]].exercises[e].questions[i].dv.my_answer_id.split(qSplt[1]).length===s+1?"":", ";appendBuffer+="</div>";break;case"type-5":appendBuffer+="<div class='qs-post-answers'>"+this.msgs.msgFeedbackRecallAnswerPrefix+$("label[for="+this.activities[ancestryIDARR[0]].exercises[e].questions[i].dv.my_answer_id+"]").text()+"</div>";break;default:fCe("Recap feedback generation encountered unknown question type")}var l="";"completed"===this.activities[ancestryIDARR[0]].exercises[e].questions[i].dv.status?(qsHide($(this.activities[ancestryIDARR[0]].exercises[e].questions[i].elem).find(".qs-feedback .qs-wrong")),l="qs-item-completed"):"failed"===this.activities[ancestryIDARR[0]].exercises[e].questions[i].dv.status&&(qsHide($(this.activities[ancestryIDARR[0]].exercises[e].questions[i].elem).find(".qs-feedback .qs-right")),l="qs-item-failed"),appendBuffer+="<div class='qs-post-feedback'>"+$(this.activities[ancestryIDARR[0]].exercises[e].questions[i].elem).find(".qs-feedback").html()+"</div>",$(o).append('<div id="'+recapItemID+'" class="qs-recap-item '+l+'">'+appendBuffer+"</div>"),$(o).find(".qs-get-current-question").removeClass("qs-get-current-question").html(d),$("#"+recapItemID+" .qs-post-feedback").find("a, input[type=button]").remove()}}else qsHide(o);qsShowSequentially("#"+this.activities[ancestryIDARR[0]].id+" .qs-post-question"),qsTransition($(this.activities[ancestryIDARR[0]].exercises[ancestryIDARR[1]].questions[ancestryIDARR[2]].elem),"#"+this.activities[ancestryIDARR[0]].id+" .qs-feedback-final"),fQsEvDp("activity_completed",{activity_dom_id:this.activities[ancestryIDARR[0]].id}),this.qsComputeActivityScore(ancestryIDARR[0],"perc")>=this.activities[ancestryIDARR[0]].final_feedback_score_threshold?(qsHide("#"+this.activities[ancestryIDARR[0]].id+" .qs-feedback-final .qs-final-negative-feedback"),qsShow("#"+this.activities[ancestryIDARR[0]].id+" .qs-feedback-final .qs-final-positive-feedback")):(qsHide("#"+this.activities[ancestryIDARR[0]].id+" .qs-feedback-final .qs-final-positive-feedback"),qsShow("#"+this.activities[ancestryIDARR[0]].id+" .qs-feedback-final .qs-final-negative-feedback")),"branching"===this.activities[ancestryIDARR[0]].activity_type&&qsHide("#"+this.activities[ancestryIDARR[0]].id+" .qs-feedback-final .qs-final-negative-feedback, #"+this.activities[ancestryIDARR[0]].id+" .qs-feedback-final .qs-final-positive-feedback"),$("#"+this.activities[ancestryIDARR[0]].id+" .qs-feedback-final .qs-retry-activity").unbind("click"),$("#"+this.activities[ancestryIDARR[0]].id+" .qs-feedback-final .qs-retry-activity").click(function(){$(this).hasClass("qs-disabled")||(fCl("---------------------------- PRESSED RESET ACTIVITY ----------------------------"),$(this).unbind(),mThis.qsResetActivity(ancestryIDARR[0]))}),$("#"+this.activities[ancestryIDARR[0]].id).find(".qs-prevquestion, .qs-nextquestion").addClass("qs-disabled"),this.qsSaveData(ancestryIDARR[0])},this.qsAddSubmitEvent=function(t,e,i){fCl("qsAddSubmitEvent("+t+","+e+","+i+")"),$("#"+this.activities[t].id+".qs-elearning-activity  #"+this.activities[t].exercises[e].id+".qs-exercise #"+this.activities[t].exercises[e].questions[i].id+".qs-question .qs-submit").attr("aria-controls",this.activities[t].exercises[e].questions[i].id),$("#"+this.activities[t].id+".qs-elearning-activity  #"+this.activities[t].exercises[e].id+".qs-exercise #"+this.activities[t].exercises[e].questions[i].id+".qs-question .qs-submit").unbind("click"),"failed"===this.activities[t].exercises[e].questions[i].dv.status||"completed"===this.activities[t].exercises[e].questions[i].dv.status?(this.activities[t].submit_all_at_once?this.qsAnswerQuestion($("#"+this.activities[t].exercises[e].questions[i].id+".qs-question"),"final-submit-all-at-once"):this.qsAnswerQuestion($("#"+this.activities[t].exercises[e].questions[i].id+".qs-question"),"auto"),"deferred"===this.activities[t].exercises[e].questions[i].feedback_type||"none"===this.activities[t].exercises[e].questions[i].feedback_type?$("#"+this.activities[t].id+".qs-elearning-activity  #"+this.activities[t].exercises[e].id+".qs-exercise #"+this.activities[t].exercises[e].questions[i].id+".qs-question .qs-submit").click(function(){$(this).hasClass("qs-disabled")||(fCl("---------------------------- PRESSED SUBMIT OVERRIDE GO TO NEXT QUESTION ----------------------------"),mThis.qsNextQuestion($(this)))}):$("#"+this.activities[t].id+".qs-elearning-activity  #"+this.activities[t].exercises[e].id+".qs-exercise #"+this.activities[t].exercises[e].questions[i].id+".qs-question .qs-submit").prop("disabled",!0).addClass("qs-disabled")):"type-5"===this.activities[t].exercises[e].questions[i].question_type?$("#"+this.activities[t].id+".qs-elearning-activity  #"+this.activities[t].exercises[e].id+".qs-exercise #"+this.activities[t].exercises[e].questions[i].id+".qs-question .qs-answers input[type=button]").click(function(){$(this).hasClass("qs-disabled")||(fCl("---------------------------- PRESSED SUBMIT BUTTON TYPE-5 ----------------------------"),mThis.qsAnswerQuestion($(this)))}):$("#"+this.activities[t].id+".qs-elearning-activity  #"+this.activities[t].exercises[e].id+".qs-exercise #"+this.activities[t].exercises[e].questions[i].id+".qs-question .qs-submit").click(function(){$(this).hasClass("qs-disabled")||(fCl("---------------------------- PRESSED SUBMIT ----------------------------"),mThis.qsAnswerQuestion($(this)))})},this.qsManageSecondChance=function(t){return fCl("qsManageSecondChance("+t+")"),fCl("Should check for qs-chance-X rather than guessing it has through JQ.length"),$("#"+t+" .qs-feedback .qs-second-chance").length?(qsHide($("#"+t+" .qs-feedback .qs-second-chance > div")),void 0===$("#"+t+" .qs-feedback .qs-second-chance").attr("data-chance-count")?($("#"+t+" .qs-feedback .qs-second-chance").attr("data-chance-count","1"),qsShow($("#"+t+" .qs-feedback .qs-second-chance > div.qs-chance-1")),!0):(nxtChanceID=Number($("#"+t+" .qs-feedback .qs-second-chance").attr("data-chance-count"))+1,$("#"+t+" .qs-feedback .qs-chance-"+nxtChanceID).length?($("#"+t+" .qs-feedback .qs-second-chance").attr("data-chance-count",nxtChanceID),qsShow($("#"+t+" .qs-feedback .qs-second-chance > div.qs-chance-"+nxtChanceID)),!0):(qsHide($("#"+t+" .qs-feedback .qs-second-chance")),!1))):!1},this.qsScrambleAnswers=function(t,e){fCl("qsScrambleAnswers("+t+","+e+")");var s="";switch(e){case"type-1":s="input[type=radio]";break;case"type-2":s="input[type=checkbox]";break;case"type-5":s="input[type=button]";break;default:return fCe("qsScrambleAnswer() says: Can't randomize question model -> "+e),!1}var a=[],r=[],n=[];for($("#"+t+" .qs-answers "+s).each(function(t){var e=!0;r[t]=[],$(this).parents().map(function(i,n){e&&(r[t].push(n),$(this).find(s).length>1&&(e=!1,a.push(r[t][i-1])))})}),$(a[0]).before('<span id="qsscrambleanswerstemp"></span>'),i=0;i<a.length;i++)n[i]=$(a[i]).detach();for(i=0;i<a.length;i++)$("#qsscrambleanswerstemp").after(n.splice(Math.floor(Math.random()*n.length),1));$("#qsscrambleanswerstemp").remove()},this.qsGenerateEncodedValidationString=function(t,e,i){fCl("qsGenerateEncodedValidationString("+t+","+e+","+i+")");var s;switch(t){case"gonogo":s=Math.floor(1e3*Math.random()),1===e?s%this.settings.masterIntTester!=0&&(s+=this.settings.masterIntTester-s%this.settings.masterIntTester):s%this.settings.masterIntTester==0&&(s+=1);break;case"encrypt":for(var a=[],r=0;r<e.length;r++)a.push(e.charCodeAt(r));s=a.join("O");break;default:fCe("WRONG ENCODING MODE")}$("#"+i).attr("data-encoded-rep",s)},this.qsTestAgainstEncodedValidationString=function(t,e){fCl("qsTestAgainstEncodedValidationString("+t+","+e+")");var i;switch(t){case"gonogo":i=!1,Number(e)%this.settings.masterIntTester===0&&(i=!0);break;case"encrypt":for(var s="",a=0;a<e.split("O").length;a++)s+=String.fromCharCode(e.split("O")[a]);i=s;break;default:fCe("WRONG DECODE MODE")}return i},this.qsGetRandomQuestionStack=function(t,e){fCl("qsGetRandomQuestionStack()");var i,s=[],a=[],r=[],n=!1;if(""!=trackingString&&(fCl("IN"),r=this.qsRecallData("qorder",[t,e]),!r instanceof Array||void 0==r.length?fCe("SHOULD BE AN ARRAY (RANDOM INDEX RECALL)"):n=!0),n)return fCl("recall "+r),r;for(i=0;i<this.activities[t].exercises[e].nb_questions;i++)s.push(i);for(i=0;i<this.activities[t].exercises[e].nb_questions;i++)a[i]=s.splice(Math.floor(Math.random()*s.length),1);return a},this.qsResetActivity=function(t){fCl("qsResetActivity("+t+") -> NOTE THAT RESETING AN ACTIVITY WILL NOT RESET THE RANDOM ORDER OF QUESTIONS!");var e,i;for(this.activities[t].dv.status="unattempted",this.activities[t].dv.current_exercise_id=0,this.activities[t].dv.current_question_id=0,e=0;e<this.activities[t].nb_exercises;e++)for(this.activities[t].exercises[e].dv.status="unattempted",i=0;i<this.activities[t].exercises[e].nb_questions;i++)this.activities[t].exercises[e].questions[i].dv.my_answer_id="",this.activities[t].exercises[e].questions[i].dv.status="unattempted";this.activities[t].tracking_enabled&&trackingObj.saveData(this.activities[t].id,""),$("#"+this.activities[t].id+" .qs-submit,#"+this.activities[t].id+" .qs-continue").prop("disabled",!1).removeClass("qs-disabled"),$("#"+this.activities[t].id+" .qs-submit,#"+this.activities[t].id+" .qs-continue").removeAttr("disabled"),$("#"+this.activities[t].id+" input[type=checkbox],#"+this.activities[t].id+" input[type=radio],#"+this.activities[t].id+" input[type=button]").prop("disabled",!1).prop("checked",!1).removeClass("qs-disabled"),$("#"+this.activities[t].id+" input[type=text],#"+this.activities[t].id+" textarea").prop("disabled",!1).removeClass("qs-disabled qs_good_answer qs_wrong_answer").val(""),$("#"+this.activities[t].id+" select").val("0"),$("#"+this.activities[t].id+" select").prop("disabled",!1).removeAttr("disabled"),this.qsPrepActivities(t)},this.qsComputeParentStatuses=function(t){fCl("qsComputeParentStatuses("+t+")");var e,i;for(activityCompleted=!0,e=0;e<this.activities[t].exercises.length;e++){for(exerciseCompleted=!0,i=0;i<this.activities[t].exercises[e].questions.length;i++)fCl("Qstatus:"+this.activities[t].exercises[e].questions[i].dv.status),"completed"!==this.activities[t].exercises[e].questions[i].dv.status&&"failed"!==this.activities[t].exercises[e].questions[i].dv.status&&(exerciseCompleted=!1,activityCompleted=!1);exerciseCompleted&&(this.activities[t].exercises[e].dv.status="completed")}activityCompleted&&(this.activities[t].dv.status="completed")},this.qsComputeActivityScore=function(t,e){var i,s=0;for(score_total=0,i=0;i<this.activities[t].exercises.length;i++)for(ii=0;ii<this.activities[t].exercises[i].questions.length;ii++)s+="completed"==this.activities[t].exercises[i].questions[ii].dv.status?1*this.activities[t].exercises[i].questions[ii].score_value:0,score_total+=1*this.activities[t].exercises[i].questions[ii].score_value;return"cssf"===e?s:"mxsc"===e?score_total:"perc"===e?Math.round(s/score_total*100):""+s+"/"+score_total},this.qsComputeProgression=function(t,e){var i,s=0;for(question_total=0,i=0;i<this.activities[t].exercises.length;i++)question_total+=this.activities[t].exercises[i].nb_questions,i<this.activities[t].dv.current_exercise_id&&(s+=this.activities[t].exercises[i].nb_questions);return"qat"===e?s+this.activities[t].dv.current_question_id+1:"qtot"===e?question_total:""+(s+this.activities[t].dv.current_question_id+1)+"/"+question_total},this.qsUpdateScoreDisplay=function(t){$("#"+this.activities[t].id+" .qs-get-current-score").text(this.qsComputeActivityScore(t,"cssf")),$("#"+this.activities[t].id+" .qs-get-max-score").text(this.qsComputeActivityScore(t,"mxsc")),$("#"+this.activities[t].id+" .qs-get-score-on100").text(this.qsComputeActivityScore(t,"perc")),$("#"+this.activities[t].id+" .qs-get-current-question").text(this.qsComputeProgression(t,"qat")),$("#"+this.activities[t].id+" .qs-get-nb-questions").text(this.qsComputeProgression(t,"qtot"))},this.qsGetActivityIDFromStringID=function(t){fID=-1;for(iga in this.activities)if(this.activities[iga].id==t){fID=iga;break}return fID},this.qsGetExerciseIDFromStringID=function(t,e){if(fCl("qsGetExerciseIDFromStringID("+t+" , "+e+")"),-1==e||isNaN(e))return fCl("ERR in qsGetExerciseIDFromStringID('"+t+"' ,"+e+")  <-- Cannot accept param(s)!"),!1;fID=-1;for(ige in this.activities[e].exercises)if(this.activities[e].exercises[ige].id==t){fID=ige;break}return fCl(fID),fID},this.qsGetQuestionIDFromStringID=function(t,e,i){if(-1==e||-1==i||isNaN(e)||isNaN(i))return fCl("ERR in qsGetQuestionIDFromStringID('"+t+"' ,"+e+", "+i+")  <-- Cannot accept param(s)!"),!1;fID=-1;for(igq in this.activities[e].exercises[i].questions)if(this.activities[e].exercises[i].questions[igq].id==t){fID=igq;break}return fID},this.qsGetAncestryStringIDS=function(t){return tArr=new Array,tArr.splice(0,0,$(t).closest(".qs-question, .qs-exercise, .qs-elearning-activity").attr("id")),tArr.splice(0,0,$(t).closest(".qs-exercise, .qs-elearning-activity").attr("id")),tArr.splice(0,0,$(t).closest(".qs-elearning-activity").attr("id")),tArr[2]==tArr[1]&&tArr.splice(2,1),tArr[1]==tArr[0]&&tArr.splice(1,1),tArr},this.qsGetAncestryIDS=function(t){return tArr=this.qsGetAncestryStringIDS(t),tbArr=new Array,tbArr[0]=parseInt(this.qsGetActivityIDFromStringID(tArr[0])),tArr.length>=2&&(tbArr[1]=parseInt(this.qsGetExerciseIDFromStringID(tArr[1],tbArr[0]))),tArr.length>=3&&(tbArr[2]=parseInt(this.qsGetQuestionIDFromStringID(tArr[2],tbArr[0],tbArr[1]))),tbArr},this.qsGetFarthestNonCommonParent=function(t,e){return fCl("qsGetFarthestNonCommonParent("+t+","+e+") *WIP-NOT WORKING RIGHT NOW!"),fCe(t),!1},this.qsGetClosestMatch=function(t,e){fCl("qsGetClosestMatch("+t+","+e+") **WIP NEEDS A RESTRICTION SO DOENST GO OUTSIDE OF CURRENT QS-QUESTION!!! ***WIP NEEDS TO CRAWL THROUGH SIBLINGS TOO!"),closestStackArr=[];var i;for(closestStackArr.push($("#"+e).siblings(t),$("#"+e).parent().find(t),$("#"+e).parent().parent().find(t),$("#"+e).parent().parent().parent().find(t)),gcmi=0;gcmi<closestStackArr.length;gcmi++)if(void 0!=closestStackArr[gcmi]){i=closestStackArr[gcmi];break}return i},this.qsGetTrackingString=function(t){fCl("qsGetTrackingString() -> MIGHT ONLY WORK FOR ONE ACTIVITY PER PAGE FOR NOW!");var e=trackingObj.getData(t);if(""==e||void 0==e)return fCl("TRACKING STRING EMPTY"),!1;e=e.trim();var i=e.split(qsMarkerStart).length==e.split(qsMarkerEnd).length?e.split(qsMarkerStart).length-1:-1;if(i>1)return fCe("CAN ONLY BE ONE ENTRY FOR QUIZSPAWNER... CHECK TRACKING STRING"),!1;if(-1==i)return fCe("NO OR ERRONEOUS ENTRY FOR QUIZSPAWNER... CHECK TRACKING STRING"),!1;var s=e.split(qsActMarkerStart).length==e.split(qsActMarkerEnd).length?e.split(qsActMarkerStart).length-1:-1,a=e.split(qsExMarkerStart).length==e.split(qsExMarkerEnd).length?e.split(qsExMarkerStart).length-1:-1;return-1==s||-1==a?(fCe("NO OR ERRONEOUS ENTRY FOR QUIZSPAWNER's ACTIVITIES OR EXERCISES... CHECK TRACKING STRING (FOR EVERY STARTING MARKER NEED AN ENDING ONE)"),!1):(0==e.indexOf(qsMarkerStart)&&e.indexOf(qsMarkerEnd)==e.length-qsMarkerEnd.length&&(e=e.split(qsMarkerStart)[1].split(qsMarkerEnd)[0]),trackingString=e,!0)},this.qsRecallData=function(t,e){fCl("qsRecallData("+t+","+e+")");var i,s,a,r,n=trackingString.split(qsActMarkerStart).length-1,c=[],o=[],d=[],l={u:"unattempted",i:"incomplete",c:"completed",f:"failed"};for(i=0;n>i;i++)if(c[i]=trackingString.split(qsActMarkerStart)[i+1],c[i]=c[i].split(qsActMarkerEnd)[0],o[i]=[],activity_string_id=c[i].split(tSplt[3]+"i:")[1].split(tSplt[4])[0],activity_id=this.qsGetActivityIDFromStringID(activity_string_id),"all"==t&&(this.activities[activity_id].dv.status=l[c[i].split(tSplt[3]+"s:")[1].split(tSplt[4])[0]],this.activities[activity_id].dv.current_exercise_id=parseInt(c[i].split(tSplt[3]+"p:")[1].split(tSplt[4])[0].split("-")[0]),this.activities[activity_id].dv.current_question_id=parseInt(c[i].split(tSplt[3]+"p:")[1].split(tSplt[4])[0].split("-")[1])),1==$("#"+activity_string_id).length)for(s=0;s<c[i].split(qsExMarkerStart).length-1;s++)for(o[i][s]=c[i].split(qsExMarkerStart)[s+1],o[i][s]=o[i][s].split(qsExMarkerEnd)[0],fCl("tracking["+i+"]["+s+"] = "+o[i][s]),exercise_string_id=o[i][s].split(tSplt[3]+"i:")[1].split(tSplt[4])[0],exercise_id=this.qsGetExerciseIDFromStringID(exercise_string_id,activity_id),"all"==t&&(this.activities[activity_id].exercises[exercise_id].dv.status=l[o[i][s].split(tSplt[3]+"s:")[1].split(tSplt[4])[0]]),o[i][s].split(tSplt[3]+"i:").length<2&&fCe("TRACKING MISSING IDs [id:xyz]"),"qorder"==t&&exercise_id==e[1]&&(r=o[i][s].split(tSplt[3]+"r:")[1].split(tSplt[4])[0],r=r.split(",")),exercise_params_string=o[i][s].split(tSplt[4]+tSplt[1])[0]+tSplt[4],question_answers_string=tSplt[1]+o[i][s].split(tSplt[4]+tSplt[1])[1],d=question_answers_string.split(tSplt[2],question_answers_string.split(tSplt[2]).length-1).join("|!|").split(tSplt[1]).join("").split("|!|"),a=0;a<d.length;a++)if(fCl(i+"-"+s+"-"+a),question_id=this.qsGetQuestionIDFromStringID(d[a].split(tSplt[0])[0],activity_id,exercise_id),"all"==t)switch(this.activities[activity_id].exercises[exercise_id].questions[question_id].dv.my_answer_id=d[a].split(tSplt[0])[2],this.activities[activity_id].exercises[exercise_id].questions[question_id].dv.status=l[d[a].split(tSplt[0])[1]],this.activities[activity_id].exercises[exercise_id].questions[question_id].question_type){case"type-0":if(d[a].split(tSplt[0])[2].split(qSplt[1]).length>1)for(iv=0;iv<d[a].split(tSplt[0])[2].split(qSplt[1]).length;iv++)$("#"+d[a].split(tSplt[0])[2].split(qSplt[1])[iv].split(qSplt[0])[0]).val(d[a].split(tSplt[0])[2].split(qSplt[1])[iv].split(qSplt[0])[1]);else $("#"+d[a].split(tSplt[0])[2].split(qSplt[0])[0]).val(d[a].split(tSplt[0])[2].split(qSplt[0])[1]);break;case"type-1":$("#"+d[a].split(tSplt[0])[2]).prop("checked","checked");break;case"type-2":d[a].split(tSplt[0])[2].split(",").length>1?$("#"+d[a].split(tSplt[0])[2].split(",").join(", #")).prop("checked","checked"):$("#"+d[a].split(tSplt[0])[2]).prop("checked","checked");break;case"type-3":if(d[a].split(tSplt[0])[2].split(qSplt[1]).length>1)for(iv=0;iv<d[a].split(tSplt[0])[2].split(qSplt[1]).length;iv++)$("#"+d[a].split(tSplt[0])[2].split(qSplt[1])[iv].split(qSplt[0])[0]).val(d[a].split(tSplt[0])[2].split(qSplt[1])[iv].split(qSplt[0])[1]);else $("#"+d[a].split(tSplt[0])[2].split(qSplt[0])[0]).val(d[a].split(tSplt[0])[2].split(qSplt[0])[1]);break;case"type-4":if(d[a].split(tSplt[0])[2].split(qSplt[1]).length>1)for(iv=0;iv<d[a].split(tSplt[0])[2].split(qSplt[1]).length;iv++)$("#"+d[a].split(tSplt[0])[2].split(qSplt[1])[iv].split(qSplt[0])[0]).val(d[a].split(tSplt[0])[2].split(qSplt[1])[iv].split(qSplt[0])[1]);else $("#"+d[a].split(tSplt[0])[2].split(qSplt[0])[0]).val(d[a].split(tSplt[0])[2].split(qSplt[0])[1]);break;case"type-5":$("#"+d[a].split(tSplt[0])[2]).addClass("checked");break;default:fCl("can't recall data on Question ID : "+activity_id+"-"+exercise_id+"-"+question_id)}return(t="qorder")?r:void 0},this.qsSaveData=function(t){if(fCl("qsSaveData("+t+")"),!this.activities[t].tracking_enabled)return fCl("No tracking required for activity: return false;"),!1;var e,i;for(saveBuff=qsActMarkerStart+tSplt[3]+"i:"+this.activities[t].id+tSplt[4],saveBuff+=tSplt[3]+"s:"+this.activities[t].dv.status.charAt(0)+tSplt[4],saveBuff+=tSplt[3]+"p:"+this.activities[t].dv.current_exercise_id+"-"+this.activities[t].dv.current_question_id+tSplt[4],e=0;e<this.activities[t].nb_exercises;e++){for(saveBuff+=qsExMarkerStart+tSplt[3]+"i:"+this.activities[t].exercises[e].id+tSplt[4],saveBuff+=tSplt[3]+"s:"+this.activities[t].exercises[e].dv.status.charAt(0)+tSplt[4],saveBuff+=tSplt[3]+"r:"+this.activities[t].exercises[e].random_order+tSplt[4],i=0;i<this.activities[t].exercises[e].nb_questions;i++)saveBuff+=tSplt[1]+this.activities[t].exercises[e].questions[i].id+tSplt[0]+this.activities[t].exercises[e].questions[i].dv.status.charAt(0)+tSplt[0]+this.activities[t].exercises[e].questions[i].dv.my_answer_id+tSplt[2];saveBuff+=qsExMarkerEnd}saveBuff+=qsActMarkerEnd,fCl(saveBuff),this.settings.debugMode&&$("#qs-tracking-debug").val(qsMarkerStart+saveBuff+qsMarkerEnd),trackingObj.saveData(this.activities[t].id,saveBuff)},this.qsValidateChars=function(t,e){fCl("qsValidateChars("+t+")"),void 0!==e&&""!==e&&"string"==typeof this.settings.illegalCharsList||(e=this.settings.illegalCharsList);var i;for(i=0;i<e.length;i++)-1!==t.indexOf(e.charAt(i))&&(t=t.split(e.charAt(i)).join(replaceIllegalCharWith),fCe("illegal char found: "+e.charAt(i)));for(fCl("CHANGE JS.substr by JS.substring (thx a lot IE8)"),i=0;i<t.length;i++)t.charCodeAt(i)>255&&(t=t.substr(0,i)+replaceIllegalCharWith+t.substr(i+replaceIllegalCharWith.length),fCe("illegal char found: "+t.charAt(i)));return fCl(t),t},this.qsValidateSemantic=function(){console.log("qsValidateSemantic()"),allgood=!1,all_ids_unique=!0,all_elements_accounted_for=!0,all_data_params_valid=!0,all_logic_appear_ok=!0,idcheckArr=new Array,$(".qs-elearning-activity *[id], .qs-elearning-activity[id]").each(function(t,e){idcheckArr.push($(e).attr("id"))}),idcheckArr.sort();for(var t in idcheckArr)if(idcheckArr[t]==idcheckArr[t-1])throw all_ids_unique=!1,new Error('All IDs must be unique, found duplicate: "'+idcheckArr[t]);var e=[];if($(".qs-elearning-activity").length<=0&&(all_elements_accounted_for=!1,e.push("Missing main .qs-elearning-activity element.")),$(".qs-elearning-activity").each(function(){$(this).find(".qs-exercise").length<=0&&(all_elements_accounted_for=!1,e.push("Missing .qs-exercise in .qs-elearning-activity")),$(this).find(".qs-exercise").each(function(){$(this).find(".qs-question").length<=0&&(all_elements_accounted_for=!1,e.push('Missing .qs-question in ".qs-elearning-activity .qs-exercise"')),$(this).find(".qs-question").each(function(){$(this).find(".qs-answers").length<=0&&(all_elements_accounted_for=!1,e.push("Missing .qs-answers in .qs-question")),$(this).find(".qs-feedback").length<=0&&(all_elements_accounted_for=!1,e.push("Missing .qs-feedback in .qs-question"))})})}),$(".qs-elearning-activity, .qs-exercise, .qs-question, .qs-answers input:not(.qs-submit)").each(function(){void 0===$(this).attr("id")&&(all_data_params_valid=!1,e.push("Missing ID for .qs-elearning-activity/.qs-exercise/.qs-question/.qs-answers input:not(.qs-submit)"))}),$(".qs-question").each(function(){switch(void 0===$(this).closest("*[data-question-type]").attr("data-question-type")?mThis.objDefVal.question.question_type:$(this).closest("*[data-question-type]").attr("data-question-type")){case"type-0":$(this).find(".qs-answers textarea").length<=0&&(all_data_params_valid=!1,e.push('Missing textarea in ".qs-question .qs-answers" with [data-question-type=type-0]'));break;case"type-1":$(this).find(".qs-answers input[type=radio]").length<=0&&(all_data_params_valid=!1,e.push('Missing input[type=radio] in ".qs-question .qs-answers" with [data-question-type=type-1]'));break;case"type-2":$(this).find(".qs-answers input[type=checkbox]").length<=0&&(all_data_params_valid=!1,e.push('Missing input[type=checkbox] in ".qs-question .qs-answers" with [data-question-type=type-2]'));break;case"type-3":$(this).find(".qs-answers input[type=text]").length<=0&&(all_data_params_valid=!1,e.push('Missing input[type=text] in ".qs-question .qs-answers" with [data-question-type=type-3]'));break;case"type-4":$(this).find(".qs-answers select").length<=0&&(all_data_params_valid=!1,e.push('Missing select in ".qs-question .qs-answers" with [data-question-type=type-4]'));break;case"type-5":$(this).find(".qs-answers input[type=button]:not(.qs-submit)").length<=0&&(all_data_params_valid=!1,e.push('Missing select in ".qs-question .qs-answers" with [data-question-type=type-5]'));break;default:console.log("Unknown data-question-type, skipping validation.")}}),e.length>0)throw new Error(e.join("\n"));return!!(all_ids_unique&&all_elements_accounted_for&&all_data_params_valid&&all_logic_appear_ok)},this.qsReturnRandomArr=function(t){if(isNaN(t))return fCe("qsReturnRandomArr(NaN)"),!1;for(tmpMatrixArr=[],randMatrixArr=[],rRi=0;rRi<t;rRi++)tmpMatrixArr[rRi]=rRi;for(rRi=0;rRi<t;rRi++)randMatrixArr[rRi]=tmpMatrixArr.splice(Math.floor(Math.random()*tmpMatrixArr.length),1);return randMatrixArr},qsFindRGX=function(t,e){var i=t,s=new RegExp(i,"g");return e.match(s)},qsHide=function(t){$(t).hide(),$(t).attr("aria-hidden",!0)},qsShow=function(t){$(t).show(),$(t).attr("aria-hidden",!1)},qsFadeOut=function(t){$(t).fadeOut(mThis.settings.animBaseDuration),$(t).attr("aria-hidden",!0)},qsFadeIn=function(t){$(t).fadeIn(mThis.settings.animBaseDuration),$(t).attr("aria-hidden",!1)},qsTransition=function(t,e){$(t).attr("aria-hidden",!0),$(t).fadeOut(mThis.settings.animBaseDuration,function(){$(e).fadeIn(mThis.settings.animBaseDuration),$(e).attr("aria-hidden",!1)})},qsShowSequentially=function(){fCl("qsShowSequentially() is inactive *WIP")},qsTFRestrictOnKey=function(t,e){return 13!=e.keyCode},$("#qs-load-tracking").click(function(){mThis.qsRecallData("all")}),$("#qs-save-tracking").click(function(){mThis.qsSaveData(0)}),this.settings.autoStart&&(this.qsInit(),$(".qs-elearning-activity").show())}"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t,e){for(var i=e||0,s=this.length;s>i;i++)if(this[i]===t)return i;return-1});var alertFallback=!1;if("undefined"!=typeof console&&"undefined"!=typeof console.log||(console={},alertFallback?(console.log=function(t){alert(t)},console.error=function(t){alert(t)}):(console.log=function(){},console.error=function(){})),void 0===$(window).triggerHandler("Framework:systemInfo")&&"undefined"==typeof masterStructure?(console.log("CSPSELF not detected."),"undefined"!=typeof masterStructure?console.log("CSPSELF V >= 1.6.2"):void 0!==$(window).triggerHandler("Framework:systemInfo")&&console.log("CSPSELF V < 1.6.2")):console.log("CSPSELF detected."),"undefined"==typeof jQuery)throw new Error("JQUERY IS NOT LOADED CORRECTLY");$(document).ready(function(){var t,e,i;for(isWETDelayNecessary=!1,wetComponentRequiredToLoad=0,wetComponentLookupArr=[[".wb-tabs",".wb-inited"]],t=0;t<$(".qs-elearning-activity").length;t++)for(e=0;e<wetComponentLookupArr.length;e++)$(".qs-elearning-activity").eq(t).parents(wetComponentLookupArr[e][0]).length>0&&(isWETDelayNecessary=!0,wetComponentRequiredToLoad++);if(isWETDelayNecessary)for(t=0;t<$(".qs-elearning-activity").length;t++)for(i=0;i<wetComponentLookupArr.length;i++)switch(wetComponentLookupArr[i][0]){case".wb-tabs":$(".wb-tabs").on("wb-ready.wb-tabs",function(){wetComponentRequiredToLoad--,"undefined"==typeof qsObj&&0===wetComponentRequiredToLoad&&(qsObj=new qsBeta("qsObj","undefined"!=typeof qsObjParams?qsObjParams:{}))})}else qsObj=new qsBeta("qsObj","undefined"!=typeof qsObjParams?qsObjParams:{})});